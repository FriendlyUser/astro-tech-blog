---
import { Footer } from '@/partials/Footer';
import { Hero } from '@/partials/Hero';
import { Navbar } from '@/partials/Navbar';
import { AppConfig } from '@/utils/AppConfig';
import Base from '@/templates/Base.astro';

import BottomSection from '../partials/BottomSection.astro';

// Full Astro Component Syntax:
// https://docs.astro.build/core-concepts/astro-components/

// call pixels api to get my collection

const pixelApiKey = '563492ad6f9170000100000175f5e0afc1be42c6a92f04397e7bee07';
const myCollectionsResp = await fetch('https://api.pexels.com/v1/collections', {
  headers: {
    Authorization: pixelApiKey,
  },
});

const myCollection = await myCollectionsResp.json();

const dallECollectionId = myCollection?.collections[0]?.id;

// fetch dalle collection from pexels api
const dallECollectionResp = await fetch(
  `https://api.pexels.com/v1/collections/${dallECollectionId}?per_page=80`,
  {
    headers: {
      Authorization: pixelApiKey,
    },
  }
);

const dallECollection = await dallECollectionResp.json();

const dallEImages = dallECollection?.media?.map((photo) => {
  return {
    src: photo.src.original,
    alt: photo.photographer,
  };
});
const title = "Photos"
const description = "Here are all my images generated by dall-e. Free feel to message to get more information or request a prompt"
---

<Base head={{ title, description }}>
  <body class="bg-slate-900 text-gray-100" data-pagefind-body>
    <Hero />

    <h2 class="text-center">Slideshow Gallery</h2>
    <p class="text-center">
      Here are all my images generated by dall-e. Free feel to message to get
      more information or request a prompt.
    </p>
    <div class="container mx-auto">
      <div>
        {dallEImages.map((dalle: any, index: number) => {
          return (
            <div class="mySlides">
              <div class="numbertext">
                {index} / {dallEImages.length}
              </div>
              <img src={dalle.src} style="width:100%" />
            </div>
          );
        })}

        <a class="photoprev" onclick="plusSlides(-1)">❮</a>
        <a class="photonext" onclick="plusSlides(1)">❯</a>

        <div class="caption-container">
          <p id="caption"></p>
        </div>

        <div class="photoRow">
          {dallEImages?.map((dalle: any, index: number) => {
            return (
              <div class="photoColumn">
                <img
                  class="demo cursor"
                  src={dalle.src}
                  style="width:100%"
                  onclick={`currentSlide(${index})`}
                  alt={dalle.alt}
                />
              </div>
            );
          })}
        </div>
      </div>
    </div>
    <BottomSection />
  </body>
</Base>