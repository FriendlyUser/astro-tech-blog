<!DOCTYPE html><html lang="en"> <head><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>How I made a book api in golang - FriendlyUsers Tech Blog</title><meta name="description" content="Implementing a book api in golang using the google books api"><meta name="author" content="David Li"><link rel="alternate" type="application/rss+xml" href="/rss.xml"><link rel="icon" type="image/x-icon" href="/favicon.ico"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2479144310234386" crossorigin="anonymous"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119155027-6"></script><script type="text/javascript">
      let slideIndex = 1;
      showSlides(slideIndex);

      function plusSlides(n) {
        showSlides((slideIndex += n));
      }

      function currentSlide(n) {
        showSlides((slideIndex = n));
      }

      function showSlides(n) {
        try {
          let i;
          let slides = document.getElementsByClassName('mySlides');
          let dots = document.getElementsByClassName('demo');
          let captionText = document.getElementById('caption');
          if (n > slides.length) {
            slideIndex = 1;
          }
          if (n < 1) {
            slideIndex = slides.length;
          }
          for (i = 0; i < slides.length; i++) {
            slides[i].style.display = 'none';
          }
          for (i = 0; i < dots.length; i++) {
            dots[i].className = dots[i].className.replace(' active', '');
          }
          slides[slideIndex - 1].style.display = 'block';
          dots[slideIndex - 1].className += ' active';
          captionText.innerHTML = dots[slideIndex - 1].alt;
        } catch (err) {
          // do nothing here
        }
      }
    </script><!-- Google Tag Manager --><!-- End Google Tag Manager --><link rel="stylesheet" href="/_astro/index.DFWZl3Z8.css" />
<style>.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}@media print{.no-print,.no-print *{display:none!important}}
</style><script type="module" src="/_astro/hoisted.CcuKkQrI.js"></script></head> <body class="bg-slate-900 text-gray-100"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K8P5P8FQ" height="0" width="0" style="display:none;visibility:hidden"></iframe> </noscript> <!-- End Google Tag Manager (noscript) --> <div class="mx-auto max-w-screen-lg px-3 py-6"><div class="flex flex-col gap-y-3 sm:flex-row sm:items-center sm:justify-between"><a href="/"><div class="flex items-center bg-gradient-to-br from-sky-500 to-cyan-400 bg-clip-text text-xl font-bold text-transparent"><svg class="mr-1 h-10 w-10 stroke-cyan-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M0 0h24v24H0z" stroke="none"></path><rect x="3" y="12" width="6" height="8" rx="1"></rect><rect x="9" y="8" width="6" height="12" rx="1"></rect><rect x="15" y="4" width="6" height="16" rx="1"></rect><path d="M4 20h14"></path></svg>David&#x27;s Blog</div></a><nav><ul class="flex gap-x-3 font-medium text-gray-200"><li class="hover:text-white"><a href="/posts">Blogs</a></li><li class="hover:text-white"><a href="https://github.com/FriendlyUser/astro-tech-blog">GitHub</a></li><li class="hover:text-white"><a href="/photos">Photos</a></li></ul></nav></div></div> <div data-pagefind-body>  <div class="mx-auto max-w-screen-lg px-3 py-6"><div><h1 class="text-center text-3xl font-bold">How I made a book api in golang</h1><div class="mt-2 text-center text-sm text-gray-400">By <!-- -->David Li<!-- --> on <!-- -->Fri, 10 January 2024</div><div class="flex place-content-center pt-2"><div class="rounded-md px-2 py-1 text-xs font-semibold bg-cyan-400 text-cyan-900"> <a href="/tags/go" style="padding-right:3px"> <category>go<!-- --> </category></a></div> <div class="rounded-md px-2 py-1 text-xs font-semibold bg-cyan-400 text-cyan-900"> <a href="/tags/googlebooks" style="padding-right:3px"> <category>googlebooks<!-- --> </category></a></div> <div class="rounded-md px-2 py-1 text-xs font-semibold bg-cyan-400 text-cyan-900"> <a href="/tags/deta" style="padding-right:3px"> <category>deta<!-- --> </category></a></div> </div><div class="mx-auto mt-5 max-w-prose"><div class="aspect-w-3 aspect-h-2"><img class="h-full w-full rounded-lg object-cover object-center" src="/imgs/2023/1246994641.png" loading="lazy"/></div><div class="prose prose-invert mt-8 prose-img:rounded-lg"><content> <p>The Google Books API is a web-based API that allows developers to access information about books and perform operations on books such as searching, retrieving, and updating book details. With the Google Books API, developers can build applications that allow users to search the Google Books catalog and retrieve information about books, including author, title, publication date, description, and cover art. They can also use the API to access reviews, ratings, and other metadata about books. The API supports various formats, including plain text, HTML, and PDF, and returns results in both JSON and XML formats.</p>
<p>Using OpenAPI to generate server-side code can be helpful in several ways:</p>
<ol>
<li>Speed and efficiency: Generating code from an OpenAPI specification can save a significant amount of time compared to manually writing the code from scratch. This can speed up the development process and make it more efficient.</li>
<li>Consistency and accuracy: When generating code, the tools can ensure that the code is consistent and conforms to the OpenAPI specification. This reduces the likelihood of introducing errors or inconsistencies into the codebase, resulting in more accurate and reliable code.</li>
<li>Reusability: OpenAPI allows developers to define their APIs in a standard, language-agnostic format, which can be reused across multiple projects and teams. By using OpenAPI to generate server-side code, developers can take advantage of this reusability and reduce the amount of time and effort required to build and maintain APIs.</li>
<li>Increased productivity: By automating certain aspects of the code generation process, developers can focus on more important tasks, such as designing and implementing new features. This can lead to increased productivity and a more streamlined development process.</li>
</ol>
<p>Overall, using OpenAPI to generate server-side code can help to reduce the amount of manual effort required to build APIs, increase accuracy and consistency, and make the development process more efficient and productive.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#88846F"> /*</span></span>
<span class="line"><span style="color:#88846F"> * BookApi API (beta ver.)</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> *  # Authentication simple no api access, no access token, just a toy project</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> * API version: 1</span></span>
<span class="line"><span style="color:#88846F"> * Generated by: OpenAPI Generator (https://openapi-generator.tech)</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">package</span><span> </span><span style="color:#A6E22E;text-decoration:underline">openapi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#E6DB74">	"context"</span></span>
<span class="line"><span style="color:#E6DB74">	"net/http"</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// BookApiRouter defines the required methods for binding the api requests to a responses for the BookApi</span></span>
<span class="line"><span style="color:#88846F">// The BookApiRouter implementation should parse necessary information from the http request,</span></span>
<span class="line"><span style="color:#88846F">// pass the data to a BookApiServicer to perform the required actions, then write the service results to the http response.</span></span>
<span class="line"><span style="color:#F92672">type</span><span> </span><span style="color:#A6E22E;text-decoration:underline">BookApiRouter</span><span style="color:#F92672"> interface</span><span style="color:#F8F8F2"> { </span></span>
<span class="line"><span style="color:#A6E22E">	BookGetBook</span><span style="color:#F8F8F2">(</span><span style="color:#A6E22E;text-decoration:underline">http</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">ResponseWriter</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">*</span><span style="color:#A6E22E;text-decoration:underline">http</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">Request</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// BookApiServicer defines the api actions for the BookApi service</span></span>
<span class="line"><span style="color:#88846F">// This interface intended to stay up to date with the openapi yaml used to generate it,</span></span>
<span class="line"><span style="color:#88846F">// while the service implementation can be ignored with the .openapi-generator-ignore file</span></span>
<span class="line"><span style="color:#88846F">// and updated with the logic required for the API.</span></span>
<span class="line"><span style="color:#F92672">type</span><span> </span><span style="color:#A6E22E;text-decoration:underline">BookApiServicer</span><span style="color:#F92672"> interface</span><span style="color:#F8F8F2"> { </span></span>
<span class="line"><span style="color:#A6E22E">	BookGetBook</span><span style="color:#F8F8F2">(</span><span style="color:#A6E22E;text-decoration:underline">context</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">Context</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">string</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">string</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">string</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">int32</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">int32</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">string</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">string</span><span style="color:#F8F8F2">) (</span><span style="color:#A6E22E;text-decoration:underline">ImplResponse</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"><span style="color:#F8F8F2"> </span></span></code></pre>
<p>This code defines two interfaces, <code>BookApiRouter</code> and <code>BookApiServicer</code>, for a beta version of a simple book API.</p>
<p>The <code>BookApiRouter</code> interface defines the method <code>BookGetBook</code>, which is used to bind the API requests to responses for the Book API. This method is expected to parse information from the incoming HTTP request, pass the data to a <code>BookApiServicer</code> to perform the required actions, and then write the service results to the HTTP response.</p>
<p>The <code>BookApiServicer</code> interface defines the API actions for the Book API service. The interface is intended to stay up-to-date with the OpenAPI specification used to generate it, while the service implementation can be updated with the necessary logic for the API. The <code>BookGetBook</code> method takes in several parameters, such as book title, author, and publication date, and returns an <code>ImplResponse</code> object along with an error.</p>
<p>It looks like this code was generated using the OpenAPI Generator tool, which is designed to automate the process of generating code from OpenAPI specifications. The generated code provides a starting point for developers to implement the logic for their API.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#88846F"> /*</span></span>
<span class="line"><span style="color:#88846F"> * BookApi API (beta ver.)</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> *  # Authentication simple no api access, no access token, just a toy project</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> * API version: 1</span></span>
<span class="line"><span style="color:#88846F"> * Generated by: OpenAPI Generator (https://openapi-generator.tech)</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">package</span><span> </span><span style="color:#A6E22E;text-decoration:underline">openapi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#88846F">	// "encoding/json"</span></span>
<span class="line"><span style="color:#E6DB74">	"net/http"</span></span>
<span class="line"><span style="color:#E6DB74">	"strings"</span></span>
<span class="line"><span style="color:#88846F">	// "github.com/gorilla/mux"</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// BookApiController binds http requests to an api service and writes the service results to the http response</span></span>
<span class="line"><span style="color:#F92672">type</span><span> </span><span style="color:#A6E22E;text-decoration:underline">BookApiController</span><span style="color:#F92672"> struct</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">	service      </span><span style="color:#A6E22E;text-decoration:underline">BookApiServicer</span></span>
<span class="line"><span style="color:#F8F8F2">	errorHandler </span><span style="color:#A6E22E;text-decoration:underline">ErrorHandler</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// BookApiOption for how the controller is set up.</span></span>
<span class="line"><span style="color:#F92672">type</span><span> </span><span style="color:#A6E22E;text-decoration:underline">BookApiOption</span><span style="color:#F92672"> func</span><span style="color:#F8F8F2">(</span><span style="color:#F92672">*</span><span style="color:#A6E22E;text-decoration:underline">BookApiController</span><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// WithBookApiErrorHandler inject ErrorHandler into controller</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> WithBookApiErrorHandler</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">h</span><span> </span><span style="color:#A6E22E;text-decoration:underline">ErrorHandler</span><span style="color:#F8F8F2">) </span><span style="color:#A6E22E;text-decoration:underline">BookApiOption</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F92672"> func</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">c</span><span style="color:#F92672"> *</span><span style="color:#A6E22E;text-decoration:underline">BookApiController</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">		c.errorHandler </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> h</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// NewBookApiController creates a default api controller</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> NewBookApiController</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">s</span><span> </span><span style="color:#A6E22E;text-decoration:underline">BookApiServicer</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">opts</span><span style="color:#F92672"> ...</span><span style="color:#A6E22E;text-decoration:underline">BookApiOption</span><span style="color:#F8F8F2">) </span><span style="color:#A6E22E;text-decoration:underline">Router</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">	controller </span><span style="color:#F92672">:=</span><span style="color:#F92672"> &#x26;</span><span style="color:#A6E22E;text-decoration:underline">BookApiController</span><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">		service:      s,</span></span>
<span class="line"><span style="color:#F8F8F2">		errorHandler: DefaultErrorHandler,</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	for</span><span style="color:#F8F8F2"> _, opt </span><span style="color:#F92672">:=</span><span style="color:#F92672"> range</span><span style="color:#F8F8F2"> opts {</span></span>
<span class="line"><span style="color:#A6E22E">		opt</span><span style="color:#F8F8F2">(controller)</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F8F8F2"> controller</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// Routes returns all the api routes for the BookApiController</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#F8F8F2"> (</span><span style="color:#FD971F;font-style:italic">c </span><span style="color:#F92672">*</span><span style="color:#A6E22E;text-decoration:underline">BookApiController</span><span style="color:#F8F8F2">) </span><span style="color:#A6E22E">Routes</span><span style="color:#F8F8F2">() </span><span style="color:#A6E22E;text-decoration:underline">Routes</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">	return</span><span> </span><span style="color:#A6E22E;text-decoration:underline">Routes</span><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">		{</span></span>
<span class="line"><span style="color:#E6DB74">			"BookGetBook"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">			strings.</span><span style="color:#A6E22E">ToUpper</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"Get"</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#E6DB74">			"/book"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">			c.BookGetBook,</span></span>
<span class="line"><span style="color:#F8F8F2">		},</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// BookGetBook - Get book details</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#F8F8F2"> (</span><span style="color:#FD971F;font-style:italic">c </span><span style="color:#F92672">*</span><span style="color:#A6E22E;text-decoration:underline">BookApiController</span><span style="color:#F8F8F2">) </span><span style="color:#A6E22E">BookGetBook</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">w</span><span> </span><span style="color:#A6E22E;text-decoration:underline">http</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">ResponseWriter</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">r</span><span style="color:#F92672"> *</span><span style="color:#A6E22E;text-decoration:underline">http</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">Request</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">	query </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> r.URL.</span><span style="color:#A6E22E">Query</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">	qParam </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> query.</span><span style="color:#A6E22E">Get</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"q"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">	filterParam </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> query.</span><span style="color:#A6E22E">Get</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"filter"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">	downloadParam </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> query.</span><span style="color:#A6E22E">Get</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"download"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">	startIndexParam, err </span><span style="color:#F92672">:=</span><span style="color:#A6E22E"> parseInt32Parameter</span><span style="color:#F8F8F2">(query.</span><span style="color:#A6E22E">Get</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"startIndex"</span><span style="color:#F8F8F2">), </span><span style="color:#AE81FF">false</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">		c.</span><span style="color:#A6E22E">errorHandler</span><span style="color:#F8F8F2">(w, r, </span><span style="color:#F92672">&#x26;</span><span style="color:#A6E22E;text-decoration:underline">ParsingError</span><span style="color:#F8F8F2">{Err: err}, </span><span style="color:#AE81FF">nil</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">		return</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"><span style="color:#F8F8F2">	maxResultsParam, err </span><span style="color:#F92672">:=</span><span style="color:#A6E22E"> parseInt32Parameter</span><span style="color:#F8F8F2">(query.</span><span style="color:#A6E22E">Get</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"maxResults"</span><span style="color:#F8F8F2">), </span><span style="color:#AE81FF">false</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">		c.</span><span style="color:#A6E22E">errorHandler</span><span style="color:#F8F8F2">(w, r, </span><span style="color:#F92672">&#x26;</span><span style="color:#A6E22E;text-decoration:underline">ParsingError</span><span style="color:#F8F8F2">{Err: err}, </span><span style="color:#AE81FF">nil</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">		return</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"><span style="color:#F8F8F2">	printTypeParam </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> query.</span><span style="color:#A6E22E">Get</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"printType"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">	orderByParam </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> query.</span><span style="color:#A6E22E">Get</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"orderBy"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">	result, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> c.service.</span><span style="color:#A6E22E">BookGetBook</span><span style="color:#F8F8F2">(r.</span><span style="color:#A6E22E">Context</span><span style="color:#F8F8F2">(), qParam, filterParam, downloadParam, startIndexParam, maxResultsParam, printTypeParam, orderByParam)</span></span>
<span class="line"><span style="color:#88846F">	// If an error occurred, encode the error with the status code</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">		c.</span><span style="color:#A6E22E">errorHandler</span><span style="color:#F8F8F2">(w, r, err, </span><span style="color:#F92672">&#x26;</span><span style="color:#F8F8F2">result)</span></span>
<span class="line"><span style="color:#F92672">		return</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"><span style="color:#88846F">	// If no error, encode the body and the result code</span></span>
<span class="line"><span style="color:#A6E22E">	EncodeJSONResponse</span><span style="color:#F8F8F2">(result.Body, </span><span style="color:#F92672">&#x26;</span><span style="color:#F8F8F2">result.Code, w)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"><span style="color:#F8F8F2"> </span></span></code></pre>
<p>This is the implementation of a server-side API for the <code>BookApi</code> service. It is written in Go and uses the net/http package for handling HTTP requests and responses.</p>
<p>The code defines a <code>BookApiController</code> struct which is responsible for binding HTTP requests to the API service and writing the service results to the HTTP response. The controller takes an instance of the <code>BookApiServicer</code> interface as its service property, which defines the API actions that the controller will call when handling requests.</p>
<p>The <code>Routes</code> method of the <code>BookApiController</code> returns an array of route definitions, where each route maps an HTTP endpoint to a specific handler function in the controller. In this case, there is only one endpoint <code>"/book"</code> which is handled by the <code>BookGetBook</code> function.</p>
<p>The <code>BookGetBook</code> function extracts the query parameters from the URL of the incoming HTTP request, parses them and passes them as arguments to the <code>BookGetBook</code> method of the <code>BookApiServicer</code> interface. The results of the service call are written to the HTTP response using the <code>EncodeJSONResponse</code> function, or an error is returned in case of an error.</p>
<p>The <code>NewBookApiController</code> function creates a new instance of the <code>BookApiController</code> and sets it up with the given options. The <code>WithBookApiErrorHandler</code> option is used to inject an instance of an error handler into the controller. This error handler is used to handle any errors that occur during the handling of requests.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#88846F"> /*</span></span>
<span class="line"><span style="color:#88846F"> * BookApi API (beta ver.)</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> *  # Authentication simple no api access, no access token, just a toy project</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> * API version: 1</span></span>
<span class="line"><span style="color:#88846F"> * Generated by: OpenAPI Generator (https://openapi-generator.tech)</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">package</span><span> </span><span style="color:#A6E22E;text-decoration:underline">openapi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#E6DB74">	"context"</span></span>
<span class="line"><span style="color:#E6DB74">	"errors"</span></span>
<span class="line"><span style="color:#E6DB74">	"fmt"</span></span>
<span class="line"><span style="color:#E6DB74">	"io"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">	// "errors"</span></span>
<span class="line"><span style="color:#E6DB74">	"encoding/json"</span></span>
<span class="line"><span style="color:#E6DB74">	"net/http"</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// BookApiService is a service that implements the logic for the BookApiServicer</span></span>
<span class="line"><span style="color:#88846F">// This service should implement the business logic for every endpoint for the BookApi API.</span></span>
<span class="line"><span style="color:#88846F">// Include any external packages or services that will be required by this service.</span></span>
<span class="line"><span style="color:#F92672">type</span><span> </span><span style="color:#A6E22E;text-decoration:underline">BookApiService</span><span style="color:#F92672"> struct</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// NewBookApiService creates a default api service</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> NewBookApiService</span><span style="color:#F8F8F2">() </span><span style="color:#A6E22E;text-decoration:underline">BookApiServicer</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F92672"> &#x26;</span><span style="color:#A6E22E;text-decoration:underline">BookApiService</span><span style="color:#F8F8F2">{}</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// BookGetBook - Get book details</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#F8F8F2"> (</span><span style="color:#FD971F;font-style:italic">s </span><span style="color:#F92672">*</span><span style="color:#A6E22E;text-decoration:underline">BookApiService</span><span style="color:#F8F8F2">) </span><span style="color:#A6E22E">BookGetBook</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">ctx</span><span> </span><span style="color:#A6E22E;text-decoration:underline">context</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">Context</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">q</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">filter</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">download</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">startIndex</span><span style="color:#66D9EF;font-style:italic"> int32</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">maxResults</span><span style="color:#66D9EF;font-style:italic"> int32</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">printType</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">orderBy</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">) (</span><span style="color:#A6E22E;text-decoration:underline">ImplResponse</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#88846F">	// TODO - update BookGetBook with the required logic for this service method.</span></span>
<span class="line"><span style="color:#88846F">	// Add api_book_service.go to the .openapi-generator-ignore to avoid overwriting this service implementation when updating open api generation.</span></span>
<span class="line"><span style="color:#88846F">	// GET API KEY FOR GOOGLE BOOKS API</span></span>
<span class="line"><span style="color:#F8F8F2">	baseUrl </span><span style="color:#F92672">:=</span><span style="color:#E6DB74"> "https://www.googleapis.com/books/v1/volumes"</span></span>
<span class="line"><span style="color:#F8F8F2">	req, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> http.</span><span style="color:#A6E22E">NewRequest</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"GET"</span><span style="color:#F8F8F2">, baseUrl, </span><span style="color:#AE81FF">nil</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#A6E22E"> Response</span><span style="color:#F8F8F2">(http.StatusNotImplemented, </span><span style="color:#AE81FF">nil</span><span style="color:#F8F8F2">), errors.</span><span style="color:#A6E22E">New</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"Need to provide a valid URL"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">	// if you appending to existing query this works fine</span></span>
<span class="line"><span style="color:#F8F8F2">	query </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> req.URL.</span><span style="color:#A6E22E">Query</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">	key </span><span style="color:#F92672">:=</span><span style="color:#A6E22E"> GetEnvVar</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"GOOGLE_BOOK_API_KEY"</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">""</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> key </span><span style="color:#F92672">==</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#A6E22E"> Response</span><span style="color:#F8F8F2">(http.StatusNotImplemented, </span><span style="color:#AE81FF">nil</span><span style="color:#F8F8F2">), errors.</span><span style="color:#A6E22E">New</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"Need to provide a valid API key"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"><span style="color:#F8F8F2">	query.</span><span style="color:#A6E22E">Add</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"key"</span><span style="color:#F8F8F2">, key)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> q </span><span style="color:#F92672">!=</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">		query.</span><span style="color:#A6E22E">Add</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"q"</span><span style="color:#F8F8F2">, q)</span></span>
<span class="line"><span style="color:#F8F8F2">	} </span><span style="color:#F92672">else</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#A6E22E"> Response</span><span style="color:#F8F8F2">(http.StatusNotImplemented, </span><span style="color:#AE81FF">nil</span><span style="color:#F8F8F2">), errors.</span><span style="color:#A6E22E">New</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"Need to provide a valid query"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">	// or you can create new url.Values struct and encode that like so</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> filter </span><span style="color:#F92672">!=</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">		// add filter validation here</span></span>
<span class="line"><span style="color:#F8F8F2">		query.</span><span style="color:#A6E22E">Add</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"filter"</span><span style="color:#F8F8F2">, filter)</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> download </span><span style="color:#F92672">!=</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">		// add download validation here</span></span>
<span class="line"><span style="color:#F8F8F2">		query.</span><span style="color:#A6E22E">Add</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"download"</span><span style="color:#F8F8F2">, download)</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">	// http.get</span></span>
<span class="line"><span style="color:#F8F8F2">	resp, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> http.</span><span style="color:#A6E22E">Get</span><span style="color:#F8F8F2">(req.URL.</span><span style="color:#A6E22E">String</span><span style="color:#F8F8F2">() </span><span style="color:#F92672">+</span><span style="color:#E6DB74"> "?"</span><span style="color:#F92672"> +</span><span style="color:#F8F8F2"> query.</span><span style="color:#A6E22E">Encode</span><span style="color:#F8F8F2">())</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">		// handle error</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"><span style="color:#F8F8F2">	fmt.</span><span style="color:#A6E22E">Println</span><span style="color:#F8F8F2">(req.URL.</span><span style="color:#A6E22E">String</span><span style="color:#F8F8F2">() </span><span style="color:#F92672">+</span><span style="color:#E6DB74"> "?"</span><span style="color:#F92672"> +</span><span style="color:#F8F8F2"> query.</span><span style="color:#A6E22E">Encode</span><span style="color:#F8F8F2">())</span></span>
<span class="line"><span style="color:#F92672">	defer</span><span style="color:#F8F8F2"> resp.Body.</span><span style="color:#A6E22E">Close</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">	body, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> io.</span><span style="color:#A6E22E">ReadAll</span><span style="color:#F8F8F2">(resp.Body)</span></span>
<span class="line"><span style="color:#F92672">	var</span><span style="color:#F8F8F2"> bookResponse </span><span style="color:#A6E22E;text-decoration:underline">GoogleBookResponse</span></span>
<span class="line"><span style="color:#F8F8F2">	err </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> json.</span><span style="color:#A6E22E">Unmarshal</span><span style="color:#F8F8F2">(body, </span><span style="color:#F92672">&#x26;</span><span style="color:#F8F8F2">bookResponse)</span></span>
<span class="line"><span style="color:#88846F">	// destructure body into GoogleBookResponse</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">	//TODO: Uncomment the next line to return response Response(200, {}) or use other options such as http.Ok ...</span></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#A6E22E"> Response</span><span style="color:#F8F8F2">(</span><span style="color:#AE81FF">200</span><span style="color:#F8F8F2">, bookResponse), </span><span style="color:#AE81FF">nil</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">	// return Response(http.StatusNotImplemented, nil), errors.New("BookGetBook method not implemented")</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"><span style="color:#F8F8F2"> </span></span></code></pre>
<p>This is a Go implementation for a simple book API. The API implements the <code>BookGetBook</code> function that retrieves information about a book from Google Books API.</p>
<p>The implementation uses the Go standard library to make an HTTP GET request to the Google Books API, retrieves the response, and unmarshals it into a Go struct <code>GoogleBookResponse</code>. The API key for the Google Books API is obtained from an environment variable.</p>
<p>The API returns an instance of the <code>ImplResponse</code> struct with the status code set to <code>200</code> and the body set to the <code>GoogleBookResponse</code> struct on success. In case of errors, the API returns an instance of the <code>ImplResponse</code> struct with the appropriate status code and an error message.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#88846F"> /*</span></span>
<span class="line"><span style="color:#88846F"> * BookApi API (beta ver.)</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> *  # Authentication simple no api access, no access token, just a toy project</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> * API version: 1</span></span>
<span class="line"><span style="color:#88846F"> * Generated by: OpenAPI Generator (https://openapi-generator.tech)</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">package</span><span> </span><span style="color:#A6E22E;text-decoration:underline">openapi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#E6DB74">	"encoding/json"</span></span>
<span class="line"><span style="color:#E6DB74">	"errors"</span></span>
<span class="line"><span style="color:#E6DB74">	"github.com/gorilla/mux"</span></span>
<span class="line"><span style="color:#E6DB74">	"io/ioutil"</span></span>
<span class="line"><span style="color:#E6DB74">	"mime/multipart"</span></span>
<span class="line"><span style="color:#E6DB74">	"net/http"</span></span>
<span class="line"><span style="color:#E6DB74">	"os"</span></span>
<span class="line"><span style="color:#E6DB74">	"strconv"</span></span>
<span class="line"><span style="color:#E6DB74">	"strings"</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// A Route defines the parameters for an api endpoint</span></span>
<span class="line"><span style="color:#F92672">type</span><span> </span><span style="color:#A6E22E;text-decoration:underline">Route</span><span style="color:#F92672"> struct</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">	Name		</span><span style="color:#66D9EF;font-style:italic">string</span></span>
<span class="line"><span style="color:#F8F8F2">	Method	  </span><span style="color:#66D9EF;font-style:italic">string</span></span>
<span class="line"><span style="color:#F8F8F2">	Pattern	 </span><span style="color:#66D9EF;font-style:italic">string</span></span>
<span class="line"><span style="color:#F8F8F2">	HandlerFunc </span><span style="color:#A6E22E;text-decoration:underline">http</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">HandlerFunc</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// Routes are a collection of defined api endpoints</span></span>
<span class="line"><span style="color:#F92672">type</span><span> </span><span style="color:#A6E22E;text-decoration:underline">Routes</span><span style="color:#F8F8F2"> []</span><span style="color:#A6E22E;text-decoration:underline">Route</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// Router defines the required methods for retrieving api routes</span></span>
<span class="line"><span style="color:#F92672">type</span><span> </span><span style="color:#A6E22E;text-decoration:underline">Router</span><span style="color:#F92672"> interface</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#A6E22E">	Routes</span><span style="color:#F8F8F2">() </span><span style="color:#A6E22E;text-decoration:underline">Routes</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">const</span><span style="color:#F8F8F2"> errMsgRequiredMissing </span><span style="color:#F92672">=</span><span style="color:#E6DB74"> "required parameter is missing"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// NewRouter creates a new router for any number of api routers</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> NewRouter</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">routers</span><span style="color:#F92672"> ...</span><span style="color:#A6E22E;text-decoration:underline">Router</span><span style="color:#F8F8F2">) </span><span style="color:#F92672">*</span><span style="color:#A6E22E;text-decoration:underline">mux</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">Router</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">	router </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> mux.</span><span style="color:#A6E22E">NewRouter</span><span style="color:#F8F8F2">().</span><span style="color:#A6E22E">StrictSlash</span><span style="color:#F8F8F2">(</span><span style="color:#AE81FF">true</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">	for</span><span style="color:#F8F8F2"> _, api </span><span style="color:#F92672">:=</span><span style="color:#F92672"> range</span><span style="color:#F8F8F2"> routers {</span></span>
<span class="line"><span style="color:#F92672">		for</span><span style="color:#F8F8F2"> _, route </span><span style="color:#F92672">:=</span><span style="color:#F92672"> range</span><span style="color:#F8F8F2"> api.</span><span style="color:#A6E22E">Routes</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F92672">			var</span><span style="color:#F8F8F2"> handler </span><span style="color:#A6E22E;text-decoration:underline">http</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">Handler</span></span>
<span class="line"><span style="color:#F8F8F2">			handler </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> route.HandlerFunc</span></span>
<span class="line"><span style="color:#F8F8F2">			handler </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> Logger</span><span style="color:#F8F8F2">(handler, route.Name)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">			router.</span></span>
<span class="line"><span style="color:#A6E22E">				Methods</span><span style="color:#F8F8F2">(route.Method).</span></span>
<span class="line"><span style="color:#A6E22E">				Path</span><span style="color:#F8F8F2">(route.Pattern).</span></span>
<span class="line"><span style="color:#A6E22E">				Name</span><span style="color:#F8F8F2">(route.Name).</span></span>
<span class="line"><span style="color:#A6E22E">				Handler</span><span style="color:#F8F8F2">(handler)</span></span>
<span class="line"><span style="color:#F8F8F2">		}</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F8F8F2"> router</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// EncodeJSONResponse uses the json encoder to write an interface to the http response with an optional status code</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> EncodeJSONResponse</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">i</span><span style="color:#F92672"> interface</span><span style="color:#F8F8F2">{}, </span><span style="color:#FD971F;font-style:italic">status</span><span style="color:#F92672"> *</span><span style="color:#66D9EF;font-style:italic">int</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">w</span><span> </span><span style="color:#A6E22E;text-decoration:underline">http</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">ResponseWriter</span><span style="color:#F8F8F2">) </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">	w.</span><span style="color:#A6E22E">Header</span><span style="color:#F8F8F2">().</span><span style="color:#A6E22E">Set</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"Content-Type"</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">"application/json; charset=UTF-8"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> status </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">		w.</span><span style="color:#A6E22E">WriteHeader</span><span style="color:#F8F8F2">(</span><span style="color:#F92672">*</span><span style="color:#F8F8F2">status)</span></span>
<span class="line"><span style="color:#F8F8F2">	} </span><span style="color:#F92672">else</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">		w.</span><span style="color:#A6E22E">WriteHeader</span><span style="color:#F8F8F2">(http.StatusOK)</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F8F8F2"> json.</span><span style="color:#A6E22E">NewEncoder</span><span style="color:#F8F8F2">(w).</span><span style="color:#A6E22E">Encode</span><span style="color:#F8F8F2">(i)</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// ReadFormFileToTempFile reads file data from a request form and writes it to a temporary file</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> ReadFormFileToTempFile</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">r</span><span style="color:#F92672"> *</span><span style="color:#A6E22E;text-decoration:underline">http</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">Request</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">key</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">) (</span><span style="color:#F92672">*</span><span style="color:#A6E22E;text-decoration:underline">os</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">File</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">	_, fileHeader, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> r.</span><span style="color:#A6E22E">FormFile</span><span style="color:#F8F8F2">(key)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#A6E22E"> readFileHeaderToTempFile</span><span style="color:#F8F8F2">(fileHeader)</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// ReadFormFilesToTempFiles reads files array data from a request form and writes it to a temporary files</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> ReadFormFilesToTempFiles</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">r</span><span style="color:#F92672"> *</span><span style="color:#A6E22E;text-decoration:underline">http</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">Request</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">key</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">) ([]</span><span style="color:#F92672">*</span><span style="color:#A6E22E;text-decoration:underline">os</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">File</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> r.</span><span style="color:#A6E22E">ParseMultipartForm</span><span style="color:#F8F8F2">(</span><span style="color:#AE81FF">32</span><span style="color:#F92672"> &#x3C;&#x3C;</span><span style="color:#AE81FF"> 20</span><span style="color:#F8F8F2">); err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	files </span><span style="color:#F92672">:=</span><span style="color:#A6E22E"> make</span><span style="color:#F8F8F2">([]</span><span style="color:#F92672">*</span><span style="color:#F8F8F2">os.File, </span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">, </span><span style="color:#A6E22E">len</span><span style="color:#F8F8F2">(r.MultipartForm.File[key]))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	for</span><span style="color:#F8F8F2"> _, fileHeader </span><span style="color:#F92672">:=</span><span style="color:#F92672"> range</span><span style="color:#F8F8F2"> r.MultipartForm.File[key] {</span></span>
<span class="line"><span style="color:#F8F8F2">		file, err </span><span style="color:#F92672">:=</span><span style="color:#A6E22E"> readFileHeaderToTempFile</span><span style="color:#F8F8F2">(fileHeader)</span></span>
<span class="line"><span style="color:#F92672">		if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">			return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">		files </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> append</span><span style="color:#F8F8F2">(files, file)</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F8F8F2"> files, </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// readFileHeaderToTempFile reads multipart.FileHeader and writes it to a temporary file</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> readFileHeaderToTempFile</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">fileHeader</span><span style="color:#F92672"> *</span><span style="color:#A6E22E;text-decoration:underline">multipart</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">FileHeader</span><span style="color:#F8F8F2">) (</span><span style="color:#F92672">*</span><span style="color:#A6E22E;text-decoration:underline">os</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;text-decoration:underline">File</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">	formFile, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> fileHeader.</span><span style="color:#A6E22E">Open</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	defer</span><span style="color:#F8F8F2"> formFile.</span><span style="color:#A6E22E">Close</span><span style="color:#F8F8F2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	fileBytes, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> ioutil.</span><span style="color:#A6E22E">ReadAll</span><span style="color:#F8F8F2">(formFile)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	file, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> ioutil.</span><span style="color:#A6E22E">TempFile</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">""</span><span style="color:#F8F8F2">, fileHeader.Filename)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	defer</span><span style="color:#F8F8F2"> file.</span><span style="color:#A6E22E">Close</span><span style="color:#F8F8F2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	file.</span><span style="color:#A6E22E">Write</span><span style="color:#F8F8F2">(fileBytes)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F8F8F2"> file, </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// parseInt64Parameter parses a string parameter to an int64.</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> parseInt64Parameter</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">param</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">required</span><span style="color:#66D9EF;font-style:italic"> bool</span><span style="color:#F8F8F2">) (</span><span style="color:#66D9EF;font-style:italic">int64</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> param </span><span style="color:#F92672">==</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		if</span><span style="color:#F8F8F2"> required {</span></span>
<span class="line"><span style="color:#F92672">			return</span><span style="color:#AE81FF"> 0</span><span style="color:#F8F8F2">, errors.</span><span style="color:#A6E22E">New</span><span style="color:#F8F8F2">(errMsgRequiredMissing)</span></span>
<span class="line"><span style="color:#F8F8F2">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> 0</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F8F8F2"> strconv.</span><span style="color:#A6E22E">ParseInt</span><span style="color:#F8F8F2">(param, </span><span style="color:#AE81FF">10</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">64</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// parseInt32Parameter parses a string parameter to an int32.</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> parseInt32Parameter</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">param</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">required</span><span style="color:#66D9EF;font-style:italic"> bool</span><span style="color:#F8F8F2">) (</span><span style="color:#66D9EF;font-style:italic">int32</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> param </span><span style="color:#F92672">==</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		if</span><span style="color:#F8F8F2"> required {</span></span>
<span class="line"><span style="color:#F92672">			return</span><span style="color:#AE81FF"> 0</span><span style="color:#F8F8F2">, errors.</span><span style="color:#A6E22E">New</span><span style="color:#F8F8F2">(errMsgRequiredMissing)</span></span>
<span class="line"><span style="color:#F8F8F2">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> 0</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	val, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> strconv.</span><span style="color:#A6E22E">ParseInt</span><span style="color:#F8F8F2">(param, </span><span style="color:#AE81FF">10</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">32</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#F92672"> -</span><span style="color:#AE81FF">1</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#66D9EF;font-style:italic"> int32</span><span style="color:#F8F8F2">(val), </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// parseBoolParameter parses a string parameter to a bool</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> parseBoolParameter</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">param</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">) (</span><span style="color:#66D9EF;font-style:italic">bool</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">	val, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> strconv.</span><span style="color:#A6E22E">ParseBool</span><span style="color:#F8F8F2">(param)</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> false</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#66D9EF;font-style:italic"> bool</span><span style="color:#F8F8F2">(val), </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// parseInt64ArrayParameter parses a string parameter containing array of values to []int64.</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> parseInt64ArrayParameter</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">param</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">delim</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">required</span><span style="color:#66D9EF;font-style:italic"> bool</span><span style="color:#F8F8F2">) ([]</span><span style="color:#66D9EF;font-style:italic">int64</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> param </span><span style="color:#F92672">==</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		if</span><span style="color:#F8F8F2"> required {</span></span>
<span class="line"><span style="color:#F92672">			return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, errors.</span><span style="color:#A6E22E">New</span><span style="color:#F8F8F2">(errMsgRequiredMissing)</span></span>
<span class="line"><span style="color:#F8F8F2">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	str </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> strings.</span><span style="color:#A6E22E">Split</span><span style="color:#F8F8F2">(param, delim)</span></span>
<span class="line"><span style="color:#F8F8F2">	ints </span><span style="color:#F92672">:=</span><span style="color:#A6E22E"> make</span><span style="color:#F8F8F2">([]</span><span style="color:#66D9EF;font-style:italic">int64</span><span style="color:#F8F8F2">, </span><span style="color:#A6E22E">len</span><span style="color:#F8F8F2">(str))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	for</span><span style="color:#F8F8F2"> i, s </span><span style="color:#F92672">:=</span><span style="color:#F92672"> range</span><span style="color:#F8F8F2"> str {</span></span>
<span class="line"><span style="color:#F92672">		if</span><span style="color:#F8F8F2"> v, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> strconv.</span><span style="color:#A6E22E">ParseInt</span><span style="color:#F8F8F2">(s, </span><span style="color:#AE81FF">10</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">64</span><span style="color:#F8F8F2">); err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">			return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">		} </span><span style="color:#F92672">else</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">			ints[i] </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> v</span></span>
<span class="line"><span style="color:#F8F8F2">		}</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F8F8F2"> ints, </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// parseInt32ArrayParameter parses a string parameter containing array of values to []int32.</span></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> parseInt32ArrayParameter</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">param</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">delim</span><span style="color:#66D9EF;font-style:italic"> string</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">required</span><span style="color:#66D9EF;font-style:italic"> bool</span><span style="color:#F8F8F2">) ([]</span><span style="color:#66D9EF;font-style:italic">int32</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">error</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F92672">	if</span><span style="color:#F8F8F2"> param </span><span style="color:#F92672">==</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">		if</span><span style="color:#F8F8F2"> required {</span></span>
<span class="line"><span style="color:#F92672">			return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, errors.</span><span style="color:#A6E22E">New</span><span style="color:#F8F8F2">(errMsgRequiredMissing)</span></span>
<span class="line"><span style="color:#F8F8F2">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">		return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	str </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> strings.</span><span style="color:#A6E22E">Split</span><span style="color:#F8F8F2">(param, delim)</span></span>
<span class="line"><span style="color:#F8F8F2">	ints </span><span style="color:#F92672">:=</span><span style="color:#A6E22E"> make</span><span style="color:#F8F8F2">([]</span><span style="color:#66D9EF;font-style:italic">int32</span><span style="color:#F8F8F2">, </span><span style="color:#A6E22E">len</span><span style="color:#F8F8F2">(str))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	for</span><span style="color:#F8F8F2"> i, s </span><span style="color:#F92672">:=</span><span style="color:#F92672"> range</span><span style="color:#F8F8F2"> str {</span></span>
<span class="line"><span style="color:#F92672">		if</span><span style="color:#F8F8F2"> v, err </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> strconv.</span><span style="color:#A6E22E">ParseInt</span><span style="color:#F8F8F2">(s, </span><span style="color:#AE81FF">10</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">32</span><span style="color:#F8F8F2">); err </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">			return</span><span style="color:#AE81FF"> nil</span><span style="color:#F8F8F2">, err</span></span>
<span class="line"><span style="color:#F8F8F2">		} </span><span style="color:#F92672">else</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">			ints[i] </span><span style="color:#F92672">=</span><span style="color:#66D9EF;font-style:italic"> int32</span><span style="color:#F8F8F2">(v)</span></span>
<span class="line"><span style="color:#F8F8F2">		}</span></span>
<span class="line"><span style="color:#F8F8F2">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">	return</span><span style="color:#F8F8F2"> ints, </span><span style="color:#AE81FF">nil</span></span>
<span class="line"><span style="color:#F8F8F2">} </span></span></code></pre>
<p>This code is an implementation of a simple RESTful API in Go. The code uses the Gorilla Mux library for routing and handling HTTP requests. The <code>Routes</code> type defines a collection of endpoints for the API, and the <code>Router</code> interface defines the method for retrieving these routes. The <code>NewRouter</code> function creates a new router using the Gorilla Mux library and allows for any number of routers to be passed in. The <code>EncodeJSONResponse</code> function is used to write a response in JSON format to the HTTP response, and the <code>ReadFormFileToTempFile</code> and <code>ReadFormFilesToTempFiles</code> functions are used to read file data from an HTTP request form and write it to a temporary file. The <code>parseInt64Parameter</code> and <code>parseInt32Parameter</code> functions are used to parse string parameters to their respective integer types.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#88846F"> /*</span></span>
<span class="line"><span style="color:#88846F"> * BookApi API (beta ver.)</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> *  # Authentication simple no api access, no access token, just a toy project</span></span>
<span class="line"><span style="color:#88846F"> *</span></span>
<span class="line"><span style="color:#88846F"> * API version: 1</span></span>
<span class="line"><span style="color:#88846F"> * Generated by: OpenAPI Generator (https://openapi-generator.tech)</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">package</span><span> </span><span style="color:#A6E22E;text-decoration:underline">main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#E6DB74">	"log"</span></span>
<span class="line"><span style="color:#E6DB74">	"net/http"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	openapi </span><span style="color:#E6DB74">"github.com/FriendlyUser/bookapi/go"</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">func</span><span style="color:#A6E22E"> main</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F8F8F2">	log.</span><span style="color:#A6E22E">Printf</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"Server started"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	BookApiService </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> openapi.</span><span style="color:#A6E22E">NewBookApiService</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">	BookApiController </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> openapi.</span><span style="color:#A6E22E">NewBookApiController</span><span style="color:#F8F8F2">(BookApiService)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">	router </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> openapi.</span><span style="color:#A6E22E">NewRouter</span><span style="color:#F8F8F2">(BookApiController)</span></span>
<span class="line"><span style="color:#88846F">	// get PORT from PORT variable</span></span>
<span class="line"><span style="color:#F8F8F2">	port </span><span style="color:#F92672">:=</span><span style="color:#F8F8F2"> openapi.</span><span style="color:#A6E22E">GetEnvVar</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"PORT"</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">"8080"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">	log.</span><span style="color:#A6E22E">Fatal</span><span style="color:#F8F8F2">(http.</span><span style="color:#A6E22E">ListenAndServe</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">":"</span><span style="color:#F92672"> +</span><span style="color:#F8F8F2"> port, router))</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"><span style="color:#F8F8F2"> </span></span></code></pre>
<p>This is a main function for a Go program that implements a simple API for a book collection. The API has no authentication and is just a toy project.</p>
<p>The program starts by logging a message that the server has started. It then creates instances of the <code>BookApiService</code> and <code>BookApiController</code> from the <code>openapi</code> package.</p>
<p>Next, the program creates an instance of the <code>Router</code> from the <code>openapi</code> package and sets it as the handler for HTTP requests. The port for the server to listen on is determined by either the <code>PORT</code> environment variable or a default value of “8080”.</p>
<p>Finally, the program starts an HTTP server and listens on the specified port. The <code>ListenAndServe</code> function will block until the server is shut down or an error occurs.</p>
<p>Using a cloud provider like AWS, Google Cloud, or Microsoft Azure to host your API can be helpful for a number of reasons:</p>
<ol>
<li>Scalability: Cloud providers have infrastructure that allows you to easily scale your API up or down depending on your usage. This can be particularly helpful for handling spikes in traffic.</li>
<li>Reliability: Cloud providers have multiple data centers and use load balancing techniques to ensure that your API is highly available.</li>
<li>Security: Cloud providers invest heavily in security, so you can benefit from the security measures they put in place, such as firewalls, encryption, and access controls.</li>
<li>Cost: Hosting your API in the cloud can be more cost-effective than maintaining your own infrastructure, especially if you are just starting out or have a limited budget.</li>
<li>Management: Cloud providers offer various management and monitoring tools that can help you manage your API more efficiently.</li>
</ol>
<p>By hosting your API on a cloud platform, you can focus on building and improving your API while the cloud provider takes care of the infrastructure, security, and scaling.</p>
<p>The Spacefile in the root of your project is used to define the configuration for your project to deployment to deta space. My Spacefile is a YAML file that contains the following sections:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2"> v: </span><span style="color:#AE81FF">0</span></span>
<span class="line"><span style="color:#F8F8F2">micros:</span></span>
<span class="line"><span style="color:#F92672">  -</span><span style="color:#F8F8F2"> name: </span><span style="color:#F92672">go-</span><span style="color:#F8F8F2">app</span></span>
<span class="line"><span style="color:#F8F8F2">    src: .</span></span>
<span class="line"><span style="color:#F8F8F2">    engine: custom</span></span>
<span class="line"><span style="color:#F8F8F2">    commands:</span></span>
<span class="line"><span style="color:#F92672">      -</span><span style="color:#F92672"> go</span><span style="color:#F8F8F2"> get</span></span>
<span class="line"><span style="color:#F92672">      -</span><span style="color:#F92672"> go</span><span style="color:#F8F8F2"> build main.</span><span style="color:#F92672">go</span></span>
<span class="line"><span style="color:#F8F8F2">    run: .</span><span style="color:#F92672">/</span><span style="color:#F8F8F2">main</span></span>
<span class="line"><span style="color:#F8F8F2">    include:</span></span>
<span class="line"><span style="color:#F92672">      -</span><span style="color:#F8F8F2"> main</span></span>
<span class="line"><span style="color:#F8F8F2">    presets:</span></span>
<span class="line"><span style="color:#F8F8F2">      env:</span></span>
<span class="line"><span style="color:#F92672">        -</span><span style="color:#F8F8F2"> name: GOOGLE_BOOK_API_KEY</span></span>
<span class="line"><span style="color:#F8F8F2">          description: Google Books API Key </span></span></code></pre>
<p>This is a definition for a microservice in the format of a Micros configuration file. This microservice, named “go-app,” will run a Go application. The source code for the application is in the current directory (<code>.</code>), and the build process involves executing the <code>go get</code> and <code>go build main.go</code> commands. The application is then executed with the <code>./main</code> command. The environment variable “GOOGLE_BOOK_API_KEY” is also specified and its purpose is described as being the Google Books API Key.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/FriendlyUser/bookapi">https://github.com/FriendlyUser/bookapi</a></li>
</ul> </content></div></div></div></div> <div class="mx-auto max-w-screen-lg px-3 py-6"> <div class="no-print flex w-full"> <form class="max-w-lg" action="https://formspree.io/f/davidli012345@gmail.com" method="POST"><div class="-mx-3 mb-6 flex flex-wrap"><div class="mb-6 w-full px-3 md:mb-0 md:w-1/2"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-first-name">First Name</label><input class="mb-3 block w-full appearance-none rounded py-3 px-4 leading-tight text-gray-700 focus:bg-white focus:outline-none" id="grid-first-name" type="text" placeholder="Jane"/></div><div class="w-full px-3 md:w-1/2"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-last-name">Last Name</label><input class="block w-full appearance-none rounded border border-gray-200  py-3 px-4 leading-tight text-gray-700 focus:border-gray-500 focus:bg-white focus:outline-none" id="grid-last-name" type="text" placeholder="Doe"/></div></div><div class="-mx-3 mb-6 flex flex-wrap"><div class="w-full px-3"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-password">E-mail</label><input class="mb-3 block w-full appearance-none rounded border py-3 px-4 leading-tight text-gray-700 focus:border-gray-500 focus:bg-white focus:outline-none" id="email" type="email"/></div></div><div class="-mx-3 mb-6 flex flex-wrap"><div class="w-full px-3"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-password">Message</label><textarea class="no-resize mb-3 block h-48 w-full resize-none appearance-none rounded border border-gray-200 py-3 px-4 leading-tight text-gray-700 focus:border-gray-500 focus:bg-white focus:outline-none" id="message"></textarea></div></div><div class="md:flex md:items-center"><div class="md:w-1/3"><button class="ml-2 shrink-0 rounded-full bg-gradient-to-br from-sky-500 to-cyan-400 px-3 py-1 text-sm font-medium text-gray-700 hover:from-sky-700 hover:to-cyan-600 focus:outline-none focus:ring-2 focus:ring-cyan-600/50" type="submit">Send</button></div><div class="md:w-2/3"></div></div></form> <div class="ml-3 max-w-lg bg-slate-300"> <link href="/_pagefind/pagefind-ui.css" rel="stylesheet"> <script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script> <div id="search" class="ml-3 p-4"></div>  </div> </div> </div>  </div> <div class="mx-auto max-w-screen-lg px-3 py-6"><div class="no-print border-t border-gray-600 pt-5"><div class="text-sm text-gray-200">© Copyright <!-- -->2024<!-- --> by <!-- -->FriendlyUsers Tech Blog<!-- -->. Built with ♥ by<!-- --> <a class="text-cyan-400 hover:underline" href="https://github.com/FriendlyUser" target="_blank" rel="noopener noreferrer">FriendlyUser</a>. Last updated on <!-- -->2024-12-19<!-- -->.</div></div><script src="https://cdn.botpress.cloud/webchat/v0/inject.js"></script><script src="https://mediafiles.botpress.cloud/0df54034-3318-451a-aed0-3923a4ee25a5/webchat/config.js" defer=""></script></div> </body></html>