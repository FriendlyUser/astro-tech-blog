<!DOCTYPE html><meta charset="utf-8"><link rel="stylesheet" href="/_astro/index.BvkiO192.css"><p>It is important to verify that humans are visiting a website because:</p>
<ol>
<li>Preventing spam and bots: Verifying that only human visitors are accessing the site can help prevent spam and bots from artificially inflating traffic or spreading malicious content.</li>
<li>Protecting user data: By ensuring that only human visitors access the site, sensitive user information can be better protected from automated scraping and cyberattacks.</li>
<li>Improving user experience: Verifying human visitors can help improve the user experience by ensuring that the site’s content and functionality is optimized for real people and not bots.</li>
<li>Measuring website performance: Accurately measuring website performance and user engagement requires accurate data about the number and behavior of human visitors.</li>
</ol>
<p>In conclusion, verifying human visitors to a website is important for improving the site’s security, performance, and user experience.</p>
<p>Cloudflare Protection is a suite of security features offered by Cloudflare, a web performance and security company. It provides a comprehensive set of tools and services to help protect websites from a wide range of online threats, including:</p>
<p>In conclusion, Cloudflare Protection offers a comprehensive set of security features that help protect websites from a wide range of online threats, improving website performance and security.</p>
<p>Since indeed has added cloudflare protection these scripts no longer work and the project has been open sourced.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583"> import</span><span style="color:#E1E4E8"> bs4</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> pandas </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> pd</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> math</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> datetime </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> datetime</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> scrapper.fetch_data </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> get_xml</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> scrapper.util </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> largest_number</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> get_num_jobs</span><span style="color:#E1E4E8">(url_indeed)-> </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">  indeed_data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> get_xml(url_indeed)</span></span>
<span class="line"><span style="color:#E1E4E8">  job_string  </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> indeed_data.find(</span><span style="color:#9ECBFF">"div"</span><span style="color:#E1E4E8">, {</span><span style="color:#9ECBFF">"id"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"searchCount"</span><span style="color:#E1E4E8">})</span></span>
<span class="line"><span style="color:#E1E4E8">  job_count_indeed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> job_string.contents[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">:</span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">  job_number_str </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> ''</span></span>
<span class="line"><span style="color:#F97583">  for</span><span style="color:#E1E4E8"> item </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> job_count_indeed:</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#79B8FF"> type</span><span style="color:#E1E4E8">(item) </span><span style="color:#F97583">is</span><span style="color:#E1E4E8"> bs4.element.Tag:</span></span>
<span class="line"><span style="color:#E1E4E8">      job_number_str </span><span style="color:#F97583">+=</span><span style="color:#E1E4E8"> item.get_text()</span></span>
<span class="line"><span style="color:#F97583">  if</span><span style="color:#E1E4E8"> job_number_str.split()[</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> 'jobs'</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Found jobs at the end'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    num_total_indeed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> largest_number(job_number_str)</span></span>
<span class="line"><span style="color:#F97583">  else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Expected to find job number'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    assert</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">  # </span></span>
<span class="line"><span style="color:#E1E4E8">  total_jobs </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> float</span><span style="color:#E1E4E8">(num_total_indeed)</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(math.ceil(total_jobs </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 10.0</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># </span><span style="color:#F97583">TODO</span><span style="color:#6A737D"> Get a config file</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> get_jobs_data</span><span style="color:#E1E4E8">(url_indeed, num_pages, default_location</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Victoria, BC'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#79B8FF">  BASE_URL_indeed</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> 'https://ca.indeed.com'</span></span>
<span class="line"><span style="color:#6A737D">  # create an empty dataframe</span></span>
<span class="line"><span style="color:#E1E4E8">  job_df_indeed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame()</span></span>
<span class="line"><span style="color:#F97583">  for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, num_pages</span><span style="color:#F97583">+</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#6A737D">    # generate the URL</span></span>
<span class="line"><span style="color:#E1E4E8">    url </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> ''</span><span style="color:#E1E4E8">.join([url_indeed, </span><span style="color:#9ECBFF">'&#x26;start='</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(i</span><span style="color:#F97583">*</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)])</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(url)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # get the HTML code from the URL</span></span>
<span class="line"><span style="color:#E1E4E8">    soup </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> get_xml(url)</span></span>
<span class="line"><span style="color:#6A737D">    # pick out all the "div" with "class="job-row"</span></span>
<span class="line"><span style="color:#E1E4E8">    divs </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.findAll(</span><span style="color:#9ECBFF">"div"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    job_divs </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [jp </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> jp </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> divs </span><span style="color:#F97583">if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> jp.get(</span><span style="color:#9ECBFF">'class'</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">is</span><span style="color:#79B8FF"> None</span></span>
<span class="line"><span style="color:#F97583">                    and</span><span style="color:#9ECBFF"> 'row'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> jp.get(</span><span style="color:#9ECBFF">'class'</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # loop for each div chunk</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> job </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> job_divs:</span></span>
<span class="line"><span style="color:#F97583">      try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">        # job id</span></span>
<span class="line"><span style="color:#79B8FF">        id</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> job.get(</span><span style="color:#9ECBFF">'data-jk'</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">None</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">        # job link related to job id</span></span>
<span class="line"><span style="color:#E1E4E8">        link </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> BASE_URL_indeed</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> '/rc/clk?jk='</span><span style="color:#F97583"> +</span><span style="color:#79B8FF"> id</span></span>
<span class="line"><span style="color:#6A737D">        # job title</span></span>
<span class="line"><span style="color:#E1E4E8">        title </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> job.find(</span><span style="color:#9ECBFF">'a'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">attrs</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span><span style="color:#9ECBFF">'data-tn-element'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'jobTitle'</span><span style="color:#E1E4E8">}).attrs[</span><span style="color:#9ECBFF">'title'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#6A737D">        # job company</span></span>
<span class="line"><span style="color:#E1E4E8">        company </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> job.find(</span><span style="color:#9ECBFF">'span'</span><span style="color:#E1E4E8">, {</span><span style="color:#9ECBFF">'class'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'company'</span><span style="color:#E1E4E8">})</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> company </span><span style="color:#F97583">is</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">          company </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> company.text.strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">          print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Company is missing'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">        # job location</span></span>
<span class="line"><span style="color:#E1E4E8">        location </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> job.find(</span><span style="color:#9ECBFF">'span'</span><span style="color:#E1E4E8">, {</span><span style="color:#9ECBFF">'class'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'location'</span><span style="color:#E1E4E8">})</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> location </span><span style="color:#F97583">is</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">          location </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> location.text.strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">          location </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> default_location</span></span>
<span class="line"><span style="color:#79B8FF">          print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Location is missing'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">      except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#79B8FF">        print</span><span style="color:#E1E4E8">(e)</span></span>
<span class="line"><span style="color:#F97583">        continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      job_df_indeed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> job_df_indeed.append({</span></span>
<span class="line"><span style="color:#9ECBFF">        'job_title'</span><span style="color:#E1E4E8">: title,</span></span>
<span class="line"><span style="color:#9ECBFF">        'job_company'</span><span style="color:#E1E4E8">: company,</span></span>
<span class="line"><span style="color:#9ECBFF">        'job_location'</span><span style="color:#E1E4E8">:location,</span></span>
<span class="line"><span style="color:#9ECBFF">        'job_link'</span><span style="color:#E1E4E8">:link},</span></span>
<span class="line"><span style="color:#FFAB70">      ignore_index</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">  cols</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">[</span><span style="color:#9ECBFF">'job_title'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'job_company'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'job_location'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'job_link'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">  job_df_indeed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> job_df_indeed[cols]</span></span>
<span class="line"><span style="color:#6A737D">  # delete the duplicated jobs using job link</span></span>
<span class="line"><span style="color:#E1E4E8">  job_df_indeed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> job_df_indeed.drop_duplicates([</span><span style="color:#9ECBFF">'job_link'</span><span style="color:#E1E4E8">], </span><span style="color:#FFAB70">keep</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'first'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> job_df_indeed</span></span>
<span class="line"><span style="color:#E1E4E8"> </span></span></code></pre>
<p>This code is a Python script that performs web scraping to collect job postings from the job search website Indeed. It uses the BeautifulSoup library to parse the HTML code of the pages and extract information such as job title, company, location, and link for each job posting.</p>
<p>The code first retrieves the number of job postings on the website by parsing the HTML code of the search results page and extracting the number of jobs found. It then uses that information to determine the number of pages of search results to retrieve.</p>
<p>Next, the code loops through each page of search results, extracts the relevant information for each job posting, and adds it to a pandas DataFrame. Finally, it returns the DataFrame containing all the job information, removing any duplicate job postings based on the job link.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583"> import</span><span style="color:#E1E4E8"> pandas </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> pd</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> re</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> scrapper.fetch_data </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> get_xml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Get an analyzer class, espeically if I have all these hardcoded values</span></span>
<span class="line"><span style="color:#E1E4E8">types </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">'Full-Time'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Full Time'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Part-Time'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Part Time'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Contract'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Contractor'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">type_lower </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [s.lower() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> s </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> types] </span><span style="color:#6A737D"># lowercases</span></span>
<span class="line"><span style="color:#6A737D"># map the type_lower to type</span></span>
<span class="line"><span style="color:#E1E4E8">type_map </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame({</span><span style="color:#9ECBFF">'raw'</span><span style="color:#E1E4E8">: types, </span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">:type_lower}) </span><span style="color:#6A737D"># create a dataframe</span></span>
<span class="line"><span style="color:#E1E4E8">type_map[</span><span style="color:#9ECBFF">'raw'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"Full-Time"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Full-Time"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Part-Time'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Part-Time'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Contract"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Contract'</span><span style="color:#E1E4E8">] </span><span style="color:#6A737D"># modify the mapping</span></span>
<span class="line"><span style="color:#E1E4E8">type_dic </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> list</span><span style="color:#E1E4E8">(type_map.set_index(</span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">).to_dict().values()).pop() </span><span style="color:#6A737D"># use the dataframe to create a dictionary</span></span>
<span class="line"><span style="color:#6A737D"># print(type_dic)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">##### Skills #####</span></span>
<span class="line"><span style="color:#E1E4E8">skills </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">'R'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Shiny'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'RStudio'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Markdown'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Latex'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'SparkR'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'D3'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'D3.js'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'Unix'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Linux'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'MySQL'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Microsoft SQL server'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'SQL'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'Python'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'SPSS'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'SAS'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'C++'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'C'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'C#'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Matlab'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Java'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'JavaScript'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'HTML'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'HTML5'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'CSS'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'CSS3'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'PHP'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Excel'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Tableau'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'AWS'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Amazon Web Services '</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Google Cloud Platform'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'GCP'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'Microsoft Azure'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Azure'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Hadoop'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Pig'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Spark'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'ZooKeeper'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'MapReduce'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Map Reduce'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Shark'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Hive'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Oozie'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Flume'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'HBase'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Cassandra'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'NoSQL'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'MongoDB'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'GIS'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Haskell'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Scala'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Ruby'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Perl'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'Mahout'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Stata'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Solidity'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">skills_lower </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [s.lower() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> s </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> skills]</span><span style="color:#6A737D"># lowercases</span></span>
<span class="line"><span style="color:#E1E4E8">skills_map </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame({</span><span style="color:#9ECBFF">'raw'</span><span style="color:#E1E4E8">:skills, </span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">:skills_lower})</span><span style="color:#6A737D"># create a dataframe</span></span>
<span class="line"><span style="color:#E1E4E8">skills_dic </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> list</span><span style="color:#E1E4E8">(skills_map.set_index(</span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">).to_dict().values()).pop()</span><span style="color:#6A737D"># use the dataframe to create a dictionary</span></span>
<span class="line"><span style="color:#6A737D"># print(skills_dic)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">##### Education #####</span></span>
<span class="line"><span style="color:#E1E4E8">edu </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">'Bachelor'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Bachelor's"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'BS'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'B.S'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'B.S.'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Master'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Master's"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Masters'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'M.S.'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'M.S'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'MS'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        'PhD'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Ph.D.'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"PhD's"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'MBA'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">edu_lower </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [s.lower() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> s </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> edu]</span><span style="color:#6A737D"># lowercases</span></span>
<span class="line"><span style="color:#E1E4E8">edu_map </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame({</span><span style="color:#9ECBFF">'raw'</span><span style="color:#E1E4E8">:edu, </span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">:edu_lower})</span><span style="color:#6A737D"># create a dataframe</span></span>
<span class="line"><span style="color:#E1E4E8">edu_dic </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> list</span><span style="color:#E1E4E8">(edu_map.set_index(</span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">).to_dict().values()).pop()</span><span style="color:#6A737D"># use the dataframe to create a dictionary</span></span>
<span class="line"><span style="color:#6A737D"># print(edu_dic)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">##### Major #####</span></span>
<span class="line"><span style="color:#E1E4E8">major </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">'Computer Science'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Statistics'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Mathematics'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Math'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Physics'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'Machine Learning'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Economics'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Software Engineering'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Engineering'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'Information System'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Quantitative Finance'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Artificial Intelligence'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'Biostatistics'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Bioinformatics'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Quantitative'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">major_lower </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [s.lower() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> s </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> major]</span><span style="color:#6A737D"># lowercases</span></span>
<span class="line"><span style="color:#E1E4E8">major_map </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame({</span><span style="color:#9ECBFF">'raw'</span><span style="color:#E1E4E8">:major, </span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">:major_lower})</span><span style="color:#6A737D"># create a dataframe</span></span>
<span class="line"><span style="color:#E1E4E8">major_dic </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> list</span><span style="color:#E1E4E8">(major_map.set_index(</span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">).to_dict().values()).pop()</span><span style="color:#6A737D"># use the dataframe to create a dictionary</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">##### Key Words ######</span></span>
<span class="line"><span style="color:#6A737D"># For AI and BCHAIN, put the keywords here, as I want to get into those areas</span></span>
<span class="line"><span style="color:#E1E4E8">keywords </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">'Blockchain'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Hashgraph'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Ethereum'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Solidity'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Truffle'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Drizzle'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Vyper'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Smart Contract'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">'Machine Learning'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Deep Learning'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Data Science'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'Big Data'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">'Web Analytics'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Regression'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Classification'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'User Experience'</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#9ECBFF">            'Streaming Data'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Real-Time'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Real Time'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Time Series'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">keywords_lower </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [s.lower() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> s </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> keywords]</span><span style="color:#6A737D"># lowercases</span></span>
<span class="line"><span style="color:#E1E4E8">keywords_map </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame({</span><span style="color:#9ECBFF">'raw'</span><span style="color:#E1E4E8">:keywords, </span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">:keywords_lower})</span><span style="color:#6A737D"># create a dataframe</span></span>
<span class="line"><span style="color:#E1E4E8">keywords_dic </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> list</span><span style="color:#E1E4E8">(keywords_map.set_index(</span><span style="color:#9ECBFF">'lower'</span><span style="color:#E1E4E8">).to_dict().values()).pop()</span><span style="color:#6A737D"># use the dataframe to create a dictionary</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> process_type</span><span style="color:#E1E4E8">(indeed_string, data_list, data_dict)-> </span><span style="color:#79B8FF">list</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">  type_matches </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">  for</span><span style="color:#E1E4E8"> typ </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> data_list:</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">(x </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> typ </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">'+'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'#'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'.'</span><span style="color:#E1E4E8">]):</span></span>
<span class="line"><span style="color:#E1E4E8">      typp </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.escape(typ) </span><span style="color:#6A737D"># make it possible to find out 'c++', 'c#', 'd3.js' without errors</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      typp </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> typ</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.search(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">(?:^</span><span style="color:#F97583">|(?&#x3C;=</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">)</span><span style="color:#79B8FF">)</span><span style="color:#9ECBFF">'</span><span style="color:#F97583"> +</span><span style="color:#E1E4E8"> typp </span><span style="color:#F97583">+</span><span style="color:#F97583"> r</span><span style="color:#9ECBFF">'</span><span style="color:#F97583">(?=</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">|</span><span style="color:#79B8FF">$</span><span style="color:#F97583">)</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, indeed_string) </span><span style="color:#6A737D"># search the string in a string</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> result:</span></span>
<span class="line"><span style="color:#E1E4E8">      type_matches.append(data_dict[typ])</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> type_matches</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> process_jobs</span><span style="color:#E1E4E8">(job_df_indeed):</span></span>
<span class="line"><span style="color:#6A737D">  ##############################################</span></span>
<span class="line"><span style="color:#6A737D">  ##### For Loop for scraping each job URL #####</span></span>
<span class="line"><span style="color:#6A737D">  ##############################################</span></span>
<span class="line"><span style="color:#6A737D">  # empty list to store details for all the jobs</span></span>
<span class="line"><span style="color:#E1E4E8">  list_type </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">  list_skill </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#6A737D">  # list_text = []</span></span>
<span class="line"><span style="color:#E1E4E8">  list_edu </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">  list_major </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">  list_keywords </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(job_df_indeed)):</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">      # get the HTML code from the URL</span></span>
<span class="line"><span style="color:#E1E4E8">      job_url </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> job_df_indeed.iloc[i][</span><span style="color:#9ECBFF">'job_link'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">      soup </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> get_xml(job_url)</span></span>
<span class="line"><span style="color:#6A737D">      # drop the chunks of 'script','style','head','title','[document]'</span></span>
<span class="line"><span style="color:#F97583">      for</span><span style="color:#E1E4E8"> elem </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> soup.findAll([</span><span style="color:#9ECBFF">'script'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'style'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'head'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'title'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">'[document]'</span><span style="color:#E1E4E8">]):</span></span>
<span class="line"><span style="color:#E1E4E8">        elem.extract()</span></span>
<span class="line"><span style="color:#6A737D">      # get the lowercases of the texts</span></span>
<span class="line"><span style="color:#E1E4E8">      texts </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.getText(</span><span style="color:#FFAB70">separator</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">).lower()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">      # cleaning the text data</span></span>
<span class="line"><span style="color:#E1E4E8">      job_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">[</span><span style="color:#85E89D;font-weight:bold">\n\r\t</span><span style="color:#79B8FF">]</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, texts) </span><span style="color:#6A737D"># remove "\n", "\r", "\t"</span></span>
<span class="line"><span style="color:#E1E4E8">      job_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#85E89D;font-weight:bold">\,</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, job_text) </span><span style="color:#6A737D"># remove ","</span></span>
<span class="line"><span style="color:#E1E4E8">      job_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#9ECBFF">'/'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, job_text) </span><span style="color:#6A737D"># remove "/"</span></span>
<span class="line"><span style="color:#E1E4E8">      job_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, job_text) </span><span style="color:#6A737D"># remove "("</span></span>
<span class="line"><span style="color:#E1E4E8">      job_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#85E89D;font-weight:bold">\)</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, job_text) </span><span style="color:#6A737D"># remove ")"</span></span>
<span class="line"><span style="color:#E1E4E8">      job_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#9ECBFF">' +'</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">,job_text) </span><span style="color:#6A737D"># remove more than one space</span></span>
<span class="line"><span style="color:#E1E4E8">      job_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#DBEDFF">r</span><span style="color:#79B8FF">\s</span><span style="color:#DBEDFF">&#x26;</span><span style="color:#79B8FF">\s</span><span style="color:#DBEDFF">d</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, job_text) </span><span style="color:#6A737D"># avoid picking 'r &#x26; d'</span></span>
<span class="line"><span style="color:#E1E4E8">      job_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#DBEDFF">r&#x26;d</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, job_text) </span><span style="color:#6A737D"># avoid picking 'r&#x26;d'</span></span>
<span class="line"><span style="color:#E1E4E8">      job_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#9ECBFF">'\.\s+'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, job_text) </span><span style="color:#6A737D"># remove "." at the end of sentences</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">      # Job types</span></span>
<span class="line"><span style="color:#E1E4E8">      list_type.append(process_type(job_text, type_lower, type_dic))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">      # Skills</span></span>
<span class="line"><span style="color:#E1E4E8">      list_skill.append(process_type(job_text, skills_lower, skills_dic))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">      # Education</span></span>
<span class="line"><span style="color:#E1E4E8">      list_edu.append(process_type(job_text, edu_lower, edu_dic))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">      # Major</span></span>
<span class="line"><span style="color:#E1E4E8">      list_major.append(process_type(job_text, major_lower, major_dic))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">      # Key Words</span></span>
<span class="line"><span style="color:#E1E4E8">      list_keywords.append(process_type(job_text, keywords_lower, keywords_dic))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">      # Stop Words removal text</span></span>
<span class="line"><span style="color:#6A737D">      # words = string.split(' ')</span></span>
<span class="line"><span style="color:#6A737D">      # job_text = set(words) - set(stop_words) # drop stop words</span></span>
<span class="line"><span style="color:#6A737D">      # list_text.append(list(job_text))</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#79B8FF">      print</span><span style="color:#E1E4E8">(e)</span></span>
<span class="line"><span style="color:#E1E4E8">      list_type.append([</span><span style="color:#9ECBFF">'Forbidden'</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#E1E4E8">      list_skill.append([</span><span style="color:#9ECBFF">'Forbidden'</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#E1E4E8">      list_edu.append([</span><span style="color:#9ECBFF">'Forbidden'</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#E1E4E8">      list_major.append([</span><span style="color:#9ECBFF">'Forbidden'</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#E1E4E8">      list_keywords.append([</span><span style="color:#9ECBFF">'Forbidden'</span><span style="color:#E1E4E8">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  job_df_indeed[</span><span style="color:#9ECBFF">'job_type'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> list_type</span></span>
<span class="line"><span style="color:#E1E4E8">  job_df_indeed[</span><span style="color:#9ECBFF">'job_skills'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> list_skill</span></span>
<span class="line"><span style="color:#E1E4E8">  job_df_indeed[</span><span style="color:#9ECBFF">'job_edu'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> list_edu</span></span>
<span class="line"><span style="color:#E1E4E8">  job_df_indeed[</span><span style="color:#9ECBFF">'job_major'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> list_major</span></span>
<span class="line"><span style="color:#E1E4E8">  job_df_indeed[</span><span style="color:#9ECBFF">'job_keywords'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> list_keywords</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> job_df_indeed</span></span>
<span class="line"><span style="color:#E1E4E8"> </span></span></code></pre>
<p>This is code for a Python function that pre-processes and maps various values related to job positions and skills to a standardized form. It defines and maps the following:</p>
<ul>
<li>Job Types: [‘Full-Time’, ‘Full Time’, ‘Part-Time’, ‘Part Time’, ‘Contract’, ‘Contractor’]</li>
<li>Skills: [‘R’, ‘Shiny’, ‘RStudio’, ‘Markdown’, ‘Latex’, ‘SparkR’, ‘D3’, ‘D3.js’,
‘Unix’, ‘Linux’, ‘MySQL’, ‘Microsoft SQL server’, ‘SQL’,
‘Python’, ‘SPSS’, ‘SAS’, ‘C++’, ‘C’, ‘C#’,‘Matlab’,‘Java’,
‘JavaScript’, ‘HTML’, ‘HTML5’, ‘CSS’, ‘CSS3’,‘PHP’, ‘Excel’, ‘Tableau’,
‘AWS’, ‘Amazon Web Services ’,‘Google Cloud Platform’, ‘GCP’,
‘Microsoft Azure’, ‘Azure’, ‘Hadoop’, ‘Pig’, ‘Spark’, ‘ZooKeeper’,
‘MapReduce’, ‘Map Reduce’,‘Shark’, ‘Hive’,‘Oozie’, ‘Flume’, ‘HBase’, ‘Cassandra’,
‘NoSQL’, ‘MongoDB’, ‘GIS’, ‘Haskell’, ‘Scala’, ‘Ruby’,‘Perl’,
‘Mahout’, ‘Stata’,‘Solidity’]</li>
<li>Education: [‘Bachelor’, “Bachelor’s”, ‘BS’, ‘B.S’, ‘B.S.’, ‘Master’, “Master’s”, ‘Masters’, ‘M.S.’, ‘M.S’, ‘MS’,
‘PhD’, ‘Ph.D.’, “PhD’s”, ‘MBA’]</li>
<li>Major: [‘Computer Science’, ‘Statistics’, ‘Mathematics’, ‘Math’,‘Physics’,
‘Machine Learning’,‘Economics’,‘Software Engineering’, ‘Engineering’,
‘Information System’, ‘Quantitative Finance’, ‘Artificial Intelligence’,
‘Biostatistics’, ‘Bioinformatics’, ‘Quantitative’]</li>
<li>Keywords: [‘Blockchain’,‘Hashgraph’,‘Ethereum’,‘Solidity’,‘Truffle’,‘Drizzle’,‘Vyper’,‘Smart Contract’,
‘Machine Learning’,‘Deep Learning’,‘Data Science’,‘Big Data’,
‘Web Analytics’, ‘Regression’, ‘Classification’, ‘User Experience’,
‘Streaming Data’, ‘Real-Time’, ‘Real Time’, ‘Time Series’]</li>
</ul>
<p>The function “process_type” takes three parameters as input:</p>
<ul>
<li>indeed_string: a string that needs to be processed</li>
<li>data_list: list of values</li>
<li>data_dict: dictionary of mapped values, created from data_list</li>
</ul>
<p>The function uses regular expression (re) and looks for matches of the values in data_list in the indeed_string. If a match is found, it uses the corresponding mapping from data_dict to return the standardized form of the matched value.</p>
<p>Overall, this code is a component of a larger system to process job data fetched from a website using the get_xml function from the scrapper.fetch_data module.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583"> import</span><span style="color:#E1E4E8"> os</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> pandas </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> pd</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> matplotlib</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> matplotlib.pyplot </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> plt</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> base64</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> mailjet_rest </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Client</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> scrapper.util </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> get_config</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> ast </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> literal_eval</span></span>
<span class="line"><span style="color:#6A737D"># </span><span style="color:#F97583">TODO</span><span style="color:#6A737D"> move to another package later</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> generate_attachments</span><span style="color:#E1E4E8">(jobs_df):</span></span>
<span class="line"><span style="color:#E1E4E8">  list_type </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> jobs_df[</span><span style="color:#9ECBFF">'job_type'</span><span style="color:#E1E4E8">].tolist()</span></span>
<span class="line"><span style="color:#E1E4E8">  list_skill </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> jobs_df[</span><span style="color:#9ECBFF">'job_skills'</span><span style="color:#E1E4E8">].tolist()</span></span>
<span class="line"><span style="color:#E1E4E8">  list_edu </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> jobs_df[</span><span style="color:#9ECBFF">'job_edu'</span><span style="color:#E1E4E8">].tolist()</span></span>
<span class="line"><span style="color:#E1E4E8">  list_keywords </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> jobs_df[</span><span style="color:#9ECBFF">'job_keywords'</span><span style="color:#E1E4E8">].tolist()</span></span>
<span class="line"><span style="color:#6A737D">  # implement later</span></span>
<span class="line"><span style="color:#E1E4E8">  unique_data_type </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> set</span><span style="color:#E1E4E8">(x </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> l </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> list_type </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> l)</span></span>
<span class="line"><span style="color:#E1E4E8">  unique_data_skills </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> set</span><span style="color:#E1E4E8">(x </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> l </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> list_skill </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> l)</span></span>
<span class="line"><span style="color:#E1E4E8">  unique_data_edu </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> set</span><span style="color:#E1E4E8">(x </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> l </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> list_edu </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> l)</span></span>
<span class="line"><span style="color:#E1E4E8">  unique_data_keywords </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> set</span><span style="color:#E1E4E8">(x </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> l </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> list_keywords </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> l)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  skills_dict</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{}</span></span>
<span class="line"><span style="color:#F97583">  for</span><span style="color:#E1E4E8"> words </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> list_skill:</span></span>
<span class="line"><span style="color:#F97583">      for</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> words:</span></span>
<span class="line"><span style="color:#F97583">          if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> skills_dict:</span></span>
<span class="line"><span style="color:#E1E4E8">              skills_dict[word]</span><span style="color:#F97583">=</span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#F97583">          else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">              skills_dict[word]</span><span style="color:#F97583">+=</span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#6A737D">  # Calculate the frequency of keywords using a dataframe, consider adding plot or other data, perhaps save a csv and load it using d3</span></span>
<span class="line"><span style="color:#E1E4E8">  result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame()</span></span>
<span class="line"><span style="color:#E1E4E8">  result[</span><span style="color:#9ECBFF">'Skill'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> skills_dict.keys()</span></span>
<span class="line"><span style="color:#E1E4E8">  result[</span><span style="color:#9ECBFF">'Count'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> skills_dict.values()</span></span>
<span class="line"><span style="color:#E1E4E8">  result[</span><span style="color:#9ECBFF">'Ranking'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> result[</span><span style="color:#9ECBFF">'Count'</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">/</span><span style="color:#79B8FF">float</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(list_skill))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">  # Make another function</span></span>
<span class="line"><span style="color:#E1E4E8">  results_dict</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{}</span></span>
<span class="line"><span style="color:#F97583">  for</span><span style="color:#E1E4E8"> words </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> list_type:</span></span>
<span class="line"><span style="color:#F97583">      for</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> words:</span></span>
<span class="line"><span style="color:#F97583">          if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> results_dict:</span></span>
<span class="line"><span style="color:#E1E4E8">              results_dict[word]</span><span style="color:#F97583">=</span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#F97583">          else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">              results_dict[word]</span><span style="color:#F97583">+=</span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#6A737D">  # Calculate the frequency of keywords using a dataframe, consider adding plot or other data, perhaps save a csv and load it using d3</span></span>
<span class="line"><span style="color:#E1E4E8">  result_type </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame()</span></span>
<span class="line"><span style="color:#E1E4E8">  result_type[</span><span style="color:#9ECBFF">'Type'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> results_dict.keys()</span></span>
<span class="line"><span style="color:#E1E4E8">  result_type[</span><span style="color:#9ECBFF">'Count'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> results_dict.values()</span></span>
<span class="line"><span style="color:#E1E4E8">  result_type.set_index(</span><span style="color:#9ECBFF">'Type'</span><span style="color:#E1E4E8">) </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  results_dict</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{}</span></span>
<span class="line"><span style="color:#F97583">  for</span><span style="color:#E1E4E8"> words </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> list_keywords:</span></span>
<span class="line"><span style="color:#F97583">      for</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> words:</span></span>
<span class="line"><span style="color:#F97583">          if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> results_dict:</span></span>
<span class="line"><span style="color:#E1E4E8">              results_dict[word]</span><span style="color:#F97583">=</span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#F97583">          else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">              results_dict[word]</span><span style="color:#F97583">+=</span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#6A737D">  # Calculate the frequency of keywords using a dataframe, consider adding plot or other data, perhaps save a csv and load it using d3</span></span>
<span class="line"><span style="color:#E1E4E8">  result_keywords </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame()</span></span>
<span class="line"><span style="color:#E1E4E8">  result_keywords[</span><span style="color:#9ECBFF">'Keywords'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> results_dict.keys()</span></span>
<span class="line"><span style="color:#E1E4E8">  result_keywords[</span><span style="color:#9ECBFF">'Count'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> results_dict.values()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  result_keywords_html </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> result_keywords.to_html()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  matplotlib.use(</span><span style="color:#9ECBFF">'Agg'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">  skill_rank_plotname </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> 'skill-ranking.png'</span></span>
<span class="line"><span style="color:#E1E4E8">  pie_plotname </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> 'pie.png'</span></span>
<span class="line"><span style="color:#E1E4E8">  attachments_objs </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">  try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">    fig </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> plt.figure() </span><span style="color:#6A737D"># Create matplotlib figure</span></span>
<span class="line"><span style="color:#E1E4E8">    default_size </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> fig.get_size_inches()</span></span>
<span class="line"><span style="color:#E1E4E8">    ax </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> fig.add_subplot(</span><span style="color:#79B8FF">111</span><span style="color:#E1E4E8">) </span><span style="color:#6A737D"># Create matplotlib axes</span></span>
<span class="line"><span style="color:#E1E4E8">    ax2 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ax.twinx() </span><span style="color:#6A737D"># Create another axes that shares the same x-axis as ax.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    width </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0.4</span></span>
<span class="line"><span style="color:#E1E4E8">    result.plot(</span><span style="color:#FFAB70">x</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Skill'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Count'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">kind</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'bar'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">table</span><span style="color:#F97583">=</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">yerr</span><span style="color:#F97583">=</span><span style="color:#79B8FF">None</span><span style="color:#E1E4E8">,</span><span style="color:#FFAB70">ax</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ax, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">width, </span><span style="color:#FFAB70">position</span><span style="color:#F97583">=</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">,</span><span style="color:#FFAB70">legend</span><span style="color:#F97583">=</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    result.plot(</span><span style="color:#FFAB70">x</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Skill'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Ranking'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">kind</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'bar'</span><span style="color:#E1E4E8">,</span><span style="color:#FFAB70">table</span><span style="color:#F97583">=</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">yerr</span><span style="color:#F97583">=</span><span style="color:#79B8FF">None</span><span style="color:#E1E4E8">,</span><span style="color:#FFAB70">ax</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ax2, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">width, </span><span style="color:#FFAB70">position</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#FFAB70">legend</span><span style="color:#F97583">=</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    ax.set_ylabel(</span><span style="color:#9ECBFF">'Count'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    ax2.set_ylabel(</span><span style="color:#9ECBFF">'Ranking'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    fig.set_size_inches((default_size[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">*</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">, default_size[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">*</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">    fig.tight_layout()</span></span>
<span class="line"><span style="color:#6A737D">    ### This should be 2 x 2 times bigger, one 2 for dpi and one 2 for default size</span></span>
<span class="line"><span style="color:#E1E4E8">    plt.savefig(skill_rank_plotname, </span><span style="color:#FFAB70">dpi</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 200</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">  except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(e)</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Failed to make image for skill_rank'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">  # On gitlab if there is a space in the file name, it doesn't send properly</span></span>
<span class="line"><span style="color:#F97583">  try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">    result_type.plot.pie(</span><span style="color:#FFAB70">y</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Count'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">labels</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">result_type[</span><span style="color:#9ECBFF">'Type'</span><span style="color:#E1E4E8">], </span><span style="color:#FFAB70">autopct</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">%1.1f%%</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">figsize</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">    plt.savefig(pie_plotname, </span><span style="color:#FFAB70">dpi</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 200</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">  except</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Failed to make pie chart for type'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">  for</span><span style="color:#E1E4E8"> index, plot_file </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> enumerate</span><span style="color:#E1E4E8">([pie_plotname, skill_rank_plotname]):</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(index)</span></span>
<span class="line"><span style="color:#F97583">    with</span><span style="color:#79B8FF"> open</span><span style="color:#E1E4E8">(plot_file, </span><span style="color:#9ECBFF">"rb"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> img_file:</span></span>
<span class="line"><span style="color:#E1E4E8">      base64_image </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> base64.b64encode(img_file.read())</span></span>
<span class="line"><span style="color:#E1E4E8">    attachments_objs.append(</span></span>
<span class="line"><span style="color:#E1E4E8">      {</span></span>
<span class="line"><span style="color:#9ECBFF">        "ContentType"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"image/png"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        "Filename"</span><span style="color:#E1E4E8">: </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">plot_file</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        "ContentID"</span><span style="color:#E1E4E8">: </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"id</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">index</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        "Base64Content"</span><span style="color:#E1E4E8">: base64_image.decode(</span><span style="color:#9ECBFF">'ascii'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">      }</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> attachments_objs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> send_mailjet_email</span><span style="color:#E1E4E8">(jobs_df, metadata):</span></span>
<span class="line"><span style="color:#E1E4E8">  api_key </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> os.environ[</span><span style="color:#9ECBFF">'MJ_APIKEY_PUBLIC'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">  api_secret </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> os.environ[</span><span style="color:#9ECBFF">'MJ_APIKEY_PRIVATE'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">  mailjet </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Client(</span><span style="color:#FFAB70">auth</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(api_key, api_secret), </span><span style="color:#FFAB70">version</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'v3.1'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">  cfg </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> get_config()</span></span>
<span class="line"><span style="color:#E1E4E8">  get_attachments </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> generate_attachments(jobs_df)</span></span>
<span class="line"><span style="color:#E1E4E8">  keywords_skills </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> """</span><span style="color:#79B8FF">\</span></span>
<span class="line"><span style="color:#9ECBFF">    &#x3C;div></span></span>
<span class="line"><span style="color:#9ECBFF">      &#x3C;h4>Graphs&#x3C;/h4></span></span>
<span class="line"><span style="color:#9ECBFF">        &#x3C;img src="cid:id0" alt = "Plot not generated" style="width:100%"/></span></span>
<span class="line"><span style="color:#9ECBFF">        &#x3C;img src="cid:id1" alt = "Plot not made" style="width:100%"/></span></span>
<span class="line"><span style="color:#9ECBFF">      &#x3C;h5> Potential Jobs &#x3C;/h5></span></span>
<span class="line"><span style="color:#79B8FF">      {jobsTable}</span></span>
<span class="line"><span style="color:#9ECBFF">    &#x3C;/div></span></span>
<span class="line"><span style="color:#9ECBFF">  """</span><span style="color:#E1E4E8">.format(</span><span style="color:#FFAB70">jobsTable</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">jobs_df.to_html())</span></span>
<span class="line"><span style="color:#E1E4E8">  data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">    'Messages'</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#E1E4E8">      {</span></span>
<span class="line"><span style="color:#9ECBFF">        "From"</span><span style="color:#E1E4E8">: {</span></span>
<span class="line"><span style="color:#9ECBFF">          "Email"</span><span style="color:#E1E4E8">: cfg[</span><span style="color:#9ECBFF">'email'</span><span style="color:#E1E4E8">][</span><span style="color:#9ECBFF">'from'</span><span style="color:#E1E4E8">],</span></span>
<span class="line"><span style="color:#9ECBFF">          "Name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"Indeed Scrapper"</span></span>
<span class="line"><span style="color:#E1E4E8">        },</span></span>
<span class="line"><span style="color:#9ECBFF">        "To"</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#E1E4E8">          {</span></span>
<span class="line"><span style="color:#9ECBFF">            "Email"</span><span style="color:#E1E4E8">: cfg[</span><span style="color:#9ECBFF">'email'</span><span style="color:#E1E4E8">][</span><span style="color:#9ECBFF">'to'</span><span style="color:#E1E4E8">],</span></span>
<span class="line"><span style="color:#9ECBFF">            "Name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"Reciever Email"</span></span>
<span class="line"><span style="color:#E1E4E8">          }</span></span>
<span class="line"><span style="color:#E1E4E8">        ],</span></span>
<span class="line"><span style="color:#9ECBFF">        "Subject"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"Job Report"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        "HTMLPart"</span><span style="color:#E1E4E8">: keywords_skills,</span></span>
<span class="line"><span style="color:#9ECBFF">        "InlinedAttachments"</span><span style="color:#E1E4E8">: get_attachments</span></span>
<span class="line"><span style="color:#E1E4E8">      }</span></span>
<span class="line"><span style="color:#E1E4E8">    ]</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">  result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> mailjet.send.create(</span><span style="color:#FFAB70">data</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">data)</span></span>
<span class="line"><span style="color:#79B8FF">  print</span><span style="color:#E1E4E8">(result.status_code)</span></span>
<span class="line"><span style="color:#79B8FF">  print</span><span style="color:#E1E4E8">(result.json())</span></span>
<span class="line"><span style="color:#E1E4E8"> </span></span></code></pre>
<p>This is a function to generate data visualization and email attachments. Given a dataframe of job information, the function first extracts information of job types, skills, education, and keywords into separate lists and computes the frequency of each item.</p>
<p>For job skills, the function uses a dictionary to store the count of each skill, converts the dictionary into a pandas dataframe, and adds a new column for the ranking of each skill. It then generates a bar plot with two y-axes showing the count and ranking of each skill and saves it as an image.</p>
<p>For job types, the function computes the frequency of each type and converts it into a pandas dataframe. It then generates a pie chart from the dataframe and saves it as an image.</p>
<p>Finally, the function converts the frequency of keywords into a pandas dataframe and converts it into HTML. It also opens the two saved images and converts them into email attachments.</p>
<p>To avoid cloudflare blocking the requests, you can use selenium, but you may need a workaround to bypass the captcha / human verification.</p>
<p>To scrape a site using selenium and python, you need to perform the following steps:</p>
<ol>
<li>Install selenium: You can install selenium by running <code>pip install selenium</code> in your terminal or command prompt.</li>
<li>Download the web driver: Selenium requires a web driver to interact with the browser. You can download the web driver for the browser of your choice from the official Selenium website.</li>
<li>Import selenium in your python script: Add the following code to import selenium in your python script: <code>from selenium import webdriver</code>.</li>
<li>Initialize the web driver: In your script, initialize the web driver by adding the following code:</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">makefile</span><span style="color:#FDAEB7;font-style:italic">`browser = webdriver.Firefox() </span><span style="color:#6A737D;font-style:italic"># for firefox browser</span></span>
<span class="line"><span style="color:#6A737D"># or</span></span>
<span class="line"><span style="color:#E1E4E8">browser </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> webdriver.Chrome() </span><span style="color:#6A737D"># for chrome browser</span></span></code></pre>
<ol start="5">
<li>Navigate to the website: Use the following code to navigate to the website you want to scrape: <code>browser.get("https://www.example.com")</code>. Replace “<a href="https://www.example.com">https://www.example.com</a>” with the URL of the website you want to scrape.</li>
<li>Find elements: To find elements on the website, you can use various methods provided by the selenium library such as <code>find_element_by_id</code>, <code>find_element_by_name</code>, <code>find_element_by_class_name</code>, <code>find_element_by_xpath</code>, etc.</li>
<li>Extract information: Once you have found the element, you can extract the information from it. For example, to extract text from a tag, you can use the following code: <code>element.text</code>.</li>
<li>Close the browser: Finally, close the browser using the following code: <code>browser.quit()</code>.</li>
</ol>
<p>Here’s a basic example of how to scrape a site using selenium and python:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">scss</span><span style="color:#FDAEB7;font-style:italic">`</span><span style="color:#F97583;font-style:italic">from</span><span style="color:#FDAEB7;font-style:italic"> selenium </span><span style="color:#F97583;font-style:italic">import</span><span style="color:#FDAEB7;font-style:italic"> webdriver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">browser </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> webdriver.Firefox()</span></span>
<span class="line"><span style="color:#E1E4E8">browser.get(</span><span style="color:#9ECBFF">"https://www.example.com"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">element </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> browser.find\</span><span style="color:#FDAEB7;font-style:italic">_element\_by\_xpath("//h1")</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(element.text)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">browser.quit()</span></span></code></pre>
<p>This code will open a firefox browser, navigate to the example.com website, find the first <code>&#x3C;h1></code> tag on the page, and print its text.</p>