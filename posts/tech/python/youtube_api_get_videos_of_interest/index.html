<!DOCTYPE html><html lang="en"> <head><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.QW52Ox2j.js"></script><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Getting youtube videos of interest in python - FriendlyUsers Tech Blog</title><meta name="description" content="In this post I will show you how to use the youtube api to get videos of interest in python."><meta name="author" content="David Li"><link rel="alternate" type="application/rss+xml" href="/rss.xml"><link rel="icon" type="image/x-icon" href="/favicon.ico"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2479144310234386" crossorigin="anonymous"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119155027-6"></script><script type="module">(function(e,n,r,t,m){e[t]=e[t]||[],e[t].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var g=n.getElementsByTagName(r)[0],a=n.createElement(r),s="";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+m+s,g.parentNode.insertBefore(a,g)})(window,document,"script","dataLayer","GTM-K8P5P8FQ");</script><script type="text/javascript">
      let slideIndex = 1;
      showSlides(slideIndex);

      function plusSlides(n) {
        showSlides((slideIndex += n));
      }

      function currentSlide(n) {
        showSlides((slideIndex = n));
      }

      function showSlides(n) {
        try {
          let i;
          let slides = document.getElementsByClassName('mySlides');
          let dots = document.getElementsByClassName('demo');
          let captionText = document.getElementById('caption');
          if (n > slides.length) {
            slideIndex = 1;
          }
          if (n < 1) {
            slideIndex = slides.length;
          }
          for (i = 0; i < slides.length; i++) {
            slides[i].style.display = 'none';
          }
          for (i = 0; i < dots.length; i++) {
            dots[i].className = dots[i].className.replace(' active', '');
          }
          slides[slideIndex - 1].style.display = 'block';
          dots[slideIndex - 1].className += ' active';
          captionText.innerHTML = dots[slideIndex - 1].alt;
        } catch (err) {
          // do nothing here
        }
      }
    </script><!-- Google Tag Manager --><script type="module">window.dataLayer=window.dataLayer||[];function a(){dataLayer.push(arguments)}a("js",new Date);a("config","UA-119155027-6");</script><!-- End Google Tag Manager --><link rel="stylesheet" href="/_astro/index.BvkiO192.css">
<style>.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}@media print{.no-print,.no-print *{display:none!important}}
</style></head> <body class="bg-slate-900 text-gray-100"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K8P5P8FQ" height="0" width="0" style="display:none;visibility:hidden"></iframe> </noscript> <!-- End Google Tag Manager (noscript) --> <div class="mx-auto max-w-screen-lg px-3 py-6"><div class="flex flex-col gap-y-3 sm:flex-row sm:items-center sm:justify-between"><a href="/"><div class="flex items-center bg-gradient-to-br from-sky-500 to-cyan-400 bg-clip-text text-xl font-bold text-transparent"><svg class="mr-1 h-10 w-10 stroke-cyan-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M0 0h24v24H0z" stroke="none"></path><rect x="3" y="12" width="6" height="8" rx="1"></rect><rect x="9" y="8" width="6" height="12" rx="1"></rect><rect x="15" y="4" width="6" height="16" rx="1"></rect><path d="M4 20h14"></path></svg>David&#x27;s Blog</div></a><nav><ul class="flex gap-x-3 font-medium text-gray-200"><li class="hover:text-white"><a href="/posts" target="_self">Blogs</a></li><li class="hover:text-white"><a href="https://github.com/FriendlyUser/astro-tech-blog" target="_self">GitHub</a></li></ul></nav></div></div> <div data-pagefind-body>  <div class="mx-auto max-w-screen-lg px-3 py-6"><div><h1 class="text-center text-3xl font-bold">Getting youtube videos of interest in python</h1><div class="mt-2 text-center text-sm text-gray-400">By <!-- -->David Li<!-- --> on <!-- -->Fri, 2 May 2024</div><div class="flex place-content-center pt-2"><div class="
      // Layout //      Shape (Updated
      to match your               &quot;For&quot; snippet) // Typography inline-flex max-w-full items-center rounded-full
      px-2.5 py-0.5                      text-xs font-medium
      bg-green-400 text-green-900          // Dynamic Color
      h-fit
    " style="height:fit-content"><span class="line-clamp-2 break-words text-left"> <a href="/tags/python" style="padding-right:3px"> <category>python<!-- --> </category></a></span></div> <div class="
      // Layout //      Shape (Updated
      to match your               &quot;For&quot; snippet) // Typography inline-flex max-w-full items-center rounded-full
      px-2.5 py-0.5                      text-xs font-medium
      bg-cyan-400 text-cyan-900          // Dynamic Color
      h-fit
    " style="height:fit-content"><span class="line-clamp-2 break-words text-left"> <a href="/tags/youtube" style="padding-right:3px"> <category>youtube<!-- --> </category></a></span></div> </div><div class="mx-auto mt-5 max-w-prose"><div class="aspect-h-2 aspect-w-3"><img class="h-full w-full rounded-lg object-cover object-center" src="/imgs/2023/1113292628.png" loading="lazy"/></div><div class="prose prose-invert mt-8 prose-img:rounded-lg"><content> <p>The YouTube API (Application Programming Interface) is a set of tools and services provided by Google that allows developers to interact with YouTube videos, channels, playlists, and other related features programmatically. The API provides a way for developers to create applications that can access and manipulate YouTube content.</p>
<p>With the YouTube API, developers can retrieve video information, upload and manage videos, search for videos and channels, and customize the YouTube experience for users. It provides a wide range of endpoints, allowing developers to perform various operations on YouTube content. Additionally, the API provides access to real-time analytics, enabling developers to gather data about video performance and engagement.</p>
<p>The YouTube API is available for use by developers for free, with some limitations on the number of requests that can be made per day. Access to certain features may require authentication and authorization through the use of API keys and OAuth 2.0. The API is available for use with a variety of programming languages, including Python, Java, JavaScript, and PHP.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583"> import</span><span style="color:#E1E4E8"> sys</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> argparse </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> ap</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> pathlib</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> glob</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> shutil</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> datetime </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> date, datetime, timedelta</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.util </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> get_config</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.youtube.get_videos </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> get_video_data_for_channel</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.youtube.yt_nlp </span><span style="color:#F97583">import</span><span style="color:#79B8FF"> YTNLP</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.email </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> send_mailjet_email</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> jinja2 </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Template</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.util.send_discord </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> send_data_to_discord</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> icecream </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> ic</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> path_to_url</span><span style="color:#E1E4E8">(url: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -> </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> url </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> ""</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> None</span></span>
<span class="line"><span style="color:#E1E4E8">    base_url </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "http://dli-invest.github.io/ytube_nlp"</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">base_url</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">/</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">url</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> main</span><span style="color:#E1E4E8">(args):</span></span>
<span class="line"><span style="color:#E1E4E8">    end_date </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(date.today())</span></span>
<span class="line"><span style="color:#E1E4E8">    raw_file </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "data/ytube/investing/yt_data.json"</span></span>
<span class="line"><span style="color:#E1E4E8">    new_entries </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">    with</span><span style="color:#79B8FF"> open</span><span style="color:#E1E4E8">(raw_file, </span><span style="color:#9ECBFF">"r"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#FFAB70"> file</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        yt_df </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> json.load(</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">    # </span><span style="color:#F97583">TODO</span><span style="color:#6A737D"> convert to object since this is so complicated</span></span>
<span class="line"><span style="color:#6A737D">    # With an object I think it would be easier to parallelize</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> report_cfg_file </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> glob.glob(</span><span style="color:#9ECBFF">"scripts/lib/cfg/*.yml"</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        report_cfg </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> get_config(report_cfg_file)</span></span>
<span class="line"><span style="color:#E1E4E8">        report_name </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> report_cfg[</span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">        output_folder </span><span style="color:#F97583">=</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">args.output</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">/</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">report_name</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span></span>
<span class="line"><span style="color:#E1E4E8">        pathlib.Path(output_folder).mkdir(</span><span style="color:#FFAB70">parents</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">exist_ok</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # video stats object per channel </span></span>
<span class="line"><span style="color:#6A737D">        # send to new discord channel for stats</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # per channel stats</span></span>
<span class="line"><span style="color:#6A737D">        # missed videos</span></span>
<span class="line"><span style="color:#6A737D">        # hit videos</span></span>
<span class="line"><span style="color:#6A737D">        # total videos per channel</span></span>
<span class="line"><span style="color:#6A737D">        # global stats</span></span>
<span class="line"><span style="color:#E1E4E8">        email_channel_data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#6A737D">        # Make channel videos</span></span>
<span class="line"><span style="color:#6A737D">        # This loop isn't extremely expensive as</span></span>
<span class="line"><span style="color:#6A737D">        # we are just fetching text from an api</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> channel </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> report_cfg[</span><span style="color:#9ECBFF">"channels"</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#E1E4E8">            channel_id </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> channel.get(</span><span style="color:#9ECBFF">"id"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            channel_label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> channel.get(</span><span style="color:#9ECBFF">"label"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> channel_id </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                video_data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> get_video_data_for_channel(channel_id)</span></span>
<span class="line"><span style="color:#6A737D">                # loop through videos</span></span>
<span class="line"><span style="color:#F97583">                for</span><span style="color:#E1E4E8"> video_info </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> video_data:</span></span>
<span class="line"><span style="color:#E1E4E8">                    video_id </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> video_info.get(</span><span style="color:#9ECBFF">"videoId"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">                    # skip if video found already</span></span>
<span class="line"><span style="color:#F97583">                    if</span><span style="color:#E1E4E8"> video_id </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> yt_df:</span></span>
<span class="line"><span style="color:#F97583">                        continue</span></span>
<span class="line"><span style="color:#E1E4E8">                    title </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> video_info.get(</span><span style="color:#9ECBFF">"title"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">                    description </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> video_info.get(</span><span style="color:#9ECBFF">"description"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">                    publishedAt </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> video_info.get(</span><span style="color:#9ECBFF">"publishedAt"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">                    with</span><span style="color:#E1E4E8"> YTNLP(</span></span>
<span class="line"><span style="color:#FFAB70">                        video_id</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">video_id, </span><span style="color:#FFAB70">html_template</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"lib/ytube.jinja2"</span></span>
<span class="line"><span style="color:#E1E4E8">                    ) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> yt_nlp:</span></span>
<span class="line"><span style="color:#6A737D">                        # this is adjusted with a date for the gh pages step</span></span>
<span class="line"><span style="color:#E1E4E8">                        file_folder </span><span style="color:#F97583">=</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">output_folder</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">/</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">end_date</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">/</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">video_id</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span></span>
<span class="line"><span style="color:#E1E4E8">                        pathlib.Path(file_folder).mkdir(</span><span style="color:#FFAB70">parents</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">exist_ok</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">                        file_path </span><span style="color:#F97583">=</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">file_folder</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">/</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">video_id</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">.json"</span></span>
<span class="line"><span style="color:#E1E4E8">                        is_generated </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> yt_nlp.gen_report_for_id(</span></span>
<span class="line"><span style="color:#E1E4E8">                            video_id, </span><span style="color:#FFAB70">report_path</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">file_path, </span><span style="color:#FFAB70">video_data</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">video_data</span></span>
<span class="line"><span style="color:#E1E4E8">                        )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">                        # temp array of objects</span></span>
<span class="line"><span style="color:#E1E4E8">                        matches_per_vid </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">                        if</span><span style="color:#E1E4E8"> title </span><span style="color:#F97583">is</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            temp_matches, _ </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> yt_nlp.get_text_matches(title)</span></span>
<span class="line"><span style="color:#E1E4E8">                            matches_per_vid </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">*</span><span style="color:#E1E4E8">matches_per_vid, </span><span style="color:#F97583">*</span><span style="color:#E1E4E8">temp_matches]</span></span>
<span class="line"><span style="color:#F97583">                        if</span><span style="color:#E1E4E8"> description </span><span style="color:#F97583">is</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            temp_matches, _ </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> yt_nlp.get_text_matches(description)</span></span>
<span class="line"><span style="color:#E1E4E8">                            matches_per_vid </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">*</span><span style="color:#E1E4E8">matches_per_vid, </span><span style="color:#F97583">*</span><span style="color:#E1E4E8">temp_matches]</span></span>
<span class="line"><span style="color:#E1E4E8">                        match_object </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> video_info</span></span>
<span class="line"><span style="color:#E1E4E8">                        match_object[</span><span style="color:#9ECBFF">"phrases"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> matches_per_vid</span></span>
<span class="line"><span style="color:#E1E4E8">                        match_object[</span><span style="color:#9ECBFF">"source"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> channel_label</span></span>
<span class="line"><span style="color:#F97583">                        if</span><span style="color:#E1E4E8"> is_generated </span><span style="color:#F97583">is</span><span style="color:#79B8FF"> False</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            match_object[</span><span style="color:#9ECBFF">"has_report"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> False</span></span>
<span class="line"><span style="color:#F97583">                        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            match_object[</span><span style="color:#9ECBFF">"has_report"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">                            # append object to pandas dataframe</span></span>
<span class="line"><span style="color:#E1E4E8">                            new_file </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">                                "date"</span><span style="color:#E1E4E8">: publishedAt,</span></span>
<span class="line"><span style="color:#9ECBFF">                                "title"</span><span style="color:#E1E4E8">: title,</span></span>
<span class="line"><span style="color:#9ECBFF">                                "source"</span><span style="color:#E1E4E8">: channel_label,</span></span>
<span class="line"><span style="color:#9ECBFF">                                "channel_id"</span><span style="color:#E1E4E8">: channel_id,</span></span>
<span class="line"><span style="color:#9ECBFF">                                "video_id"</span><span style="color:#E1E4E8">: video_id,</span></span>
<span class="line"><span style="color:#9ECBFF">                                "url"</span><span style="color:#E1E4E8">: </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"https://www.youtube.com/watch?v=</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">video_id</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">                                "keywords"</span><span style="color:#E1E4E8">: [],</span></span>
<span class="line"><span style="color:#9ECBFF">                                "description"</span><span style="color:#E1E4E8">: description,</span></span>
<span class="line"><span style="color:#6A737D">                                # path to access file from website, need to control and replace all files again.</span></span>
<span class="line"><span style="color:#9ECBFF">                                "transcript_path"</span><span style="color:#E1E4E8">: </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">file_path</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#6A737D">                                # need to get url to build file somehow</span></span>
<span class="line"><span style="color:#E1E4E8">                            }</span></span>
<span class="line"><span style="color:#E1E4E8">                            current_year </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> date.today().year</span></span>
<span class="line"><span style="color:#E1E4E8">                            match_object[</span><span style="color:#9ECBFF">"video_path"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"/ytube/</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">channel_label</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">/</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">current_year</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">/</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">video_id</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span></span>
<span class="line"><span style="color:#6A737D">                            # df.loc[video_id] = new_file</span></span>
<span class="line"><span style="color:#F97583">                            if</span><span style="color:#E1E4E8"> video_id </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> yt_df:</span></span>
<span class="line"><span style="color:#79B8FF">                                print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Video </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">video_id</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> exists - not setting vid_id"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">                            else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">                                if</span><span style="color:#E1E4E8"> is_generated:</span></span>
<span class="line"><span style="color:#E1E4E8">                                    ic(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"adding video for channel </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">channel_id</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> and video </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">video_id</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">                                    # add row to df</span></span>
<span class="line"><span style="color:#E1E4E8">                                    new_entries.append(new_file)</span></span>
<span class="line"><span style="color:#E1E4E8">                                    yt_df.append(new_file)</span></span>
<span class="line"><span style="color:#F97583">                                else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">                                    print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Updating is_generate flag"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">                    if</span><span style="color:#E1E4E8"> channel.get(</span><span style="color:#9ECBFF">"only_on_nlp_match"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">is</span><span style="color:#79B8FF"> True</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">                        # check for nlp matches</span></span>
<span class="line"><span style="color:#F97583">                        if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(match_object[</span><span style="color:#9ECBFF">"phrases"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            email_channel_data.append(match_object)</span></span>
<span class="line"><span style="color:#F97583">                    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                        email_channel_data.append(match_object)</span></span>
<span class="line"><span style="color:#F97583">            else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                ic(</span><span style="color:#9ECBFF">"Channel not found for"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">                ic(channel) </span></span></code></pre>
<p>This is a Python script that utilizes the YouTube API to fetch video data for specific channels and apply natural language processing (NLP) to the videos’ metadata, including titles and descriptions. The script also generates reports for each video and adds new videos to a JSON file.</p>
<p>Here is a breakdown of the main components of the script:</p>
<h3 id="importing-libraries">Importing Libraries</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> sys</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> argparse </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> ap</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> pathlib</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> glob</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> shutil</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> datetime </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> date, datetime, timedelta</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.util </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> get_config</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.youtube.get_videos </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> get_video_data_for_channel</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.youtube.yt_nlp </span><span style="color:#F97583">import</span><span style="color:#79B8FF"> YTNLP</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.email </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> send_mailjet_email</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> jinja2 </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Template</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> lib.util.send_discord </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> send_data_to_discord</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> icecream </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> ic</span><span style="color:#FDAEB7;font-style:italic">`</span></span></code></pre>
<p>The script imports several libraries that are used throughout the code. These include argparse, pathlib, glob, and json for file handling; datetime and timedelta for working with dates; and several custom libraries for working with the YouTube API and sending email and Discord messages.</p>
<h3 id="main-function">Main Function</h3>
<p>The main function reads a JSON file containing existing YouTube video data, reads YAML configuration files from a specified folder, and fetches new data for each YouTube channel specified in the configuration file. It then generates reports using an external template library (Jinja2) and saves the reports as JSON files. It also extracts text matches for each video’s title and description, and appends the video data to a Pandas dataframe if it’s new. If the “only_on_nlp_match” flag is set to True for a channel, it adds the video data to an email channel data list only if there are text matches found.</p>
<p>The code could be improved by separating the different functionalities into different functions or classes, adding error handling, and improving code readability and maintainability. It could also benefit from more comments and documentation to make it easier to understand the purpose and behavior of the code. Additionally, it may be worth considering using a database instead of a JSON file for storing the video data.</p>
<p>To send reports to email using Jinja and Mailjet, you can follow these steps:</p>
<ol>
<li>Install the <code>jinja2</code> and <code>mailjet_rest</code> Python packages. You can install them using pip:</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">pip install jinja2 mailjet_rest</span></span></code></pre>
<ol start="2">
<li>Set up a Mailjet account and get your API key and API secret key.</li>
<li>Create a Jinja template for your report. This template should include placeholders for the data that will be inserted into the report. For example:</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#E1E4E8">css`&#x3C;</span><span style="color:#85E89D">h1</span><span style="color:#E1E4E8">>Report for {{ date }}&#x3C;/</span><span style="color:#85E89D">h1</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">p</span><span style="color:#E1E4E8">>Number of new subscribers: {{ new_subscribers }}&#x3C;/</span><span style="color:#85E89D">p</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">p</span><span style="color:#E1E4E8">>Total revenue: {{ revenue }}&#x3C;/</span><span style="color:#85E89D">p</span><span style="color:#E1E4E8">></span></span></code></pre>
<ol start="4">
<li>In your Python script, load the Jinja template and render it with the data for your report. For example:</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> jinja2 </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Environment, FileSystemLoader</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Load the Jinja template from a file</span></span>
<span class="line"><span style="color:#E1E4E8">file_loader </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> FileSystemLoader(os.path.dirname(</span><span style="color:#79B8FF">__file__</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">env </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Environment(</span><span style="color:#FFAB70">loader</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">file_loader)</span></span>
<span class="line"><span style="color:#E1E4E8">template </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> env.get_template(</span><span style="color:#9ECBFF">'report\_template.html'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Render the template with the data for the report</span></span>
<span class="line"><span style="color:#E1E4E8">report_data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF"> 'date'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'2022-02-15'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF"> 'new\_subscribers'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">100</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF"> 'revenue'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1000.00</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"><span style="color:#E1E4E8">report </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> template.render(report_data)</span></span></code></pre>
<ol start="5">
<li>Use the Mailjet API to send the report via email. For example:</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> mailjet_rest </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Client</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Set up the Mailjet API client</span></span>
<span class="line"><span style="color:#E1E4E8">api_key </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> 'your\_api\_key'</span></span>
<span class="line"><span style="color:#E1E4E8">api_secret </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> 'your\_api\_secret'</span></span>
<span class="line"><span style="color:#E1E4E8">mailjet </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Client(</span><span style="color:#FFAB70">auth</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(api_key, api_secret), </span><span style="color:#FFAB70">version</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'v3.1'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Define the email message</span></span>
<span class="line"><span style="color:#E1E4E8">message </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF"> 'From'</span><span style="color:#E1E4E8">: {</span></span>
<span class="line"><span style="color:#9ECBFF"> 'Email'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'sender@example.com'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF"> 'Name'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'Sender Name'</span></span>
<span class="line"><span style="color:#E1E4E8"> },</span></span>
<span class="line"><span style="color:#9ECBFF"> 'To'</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF"> 'Email'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'recipient@example.com'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF"> 'Name'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'Recipient Name'</span></span>
<span class="line"><span style="color:#E1E4E8"> }</span></span>
<span class="line"><span style="color:#E1E4E8"> ],</span></span>
<span class="line"><span style="color:#9ECBFF"> 'Subject'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'Report for 2022-02-15'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF"> 'HTMLPart'</span><span style="color:#E1E4E8">: report</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Send the email</span></span>
<span class="line"><span style="color:#E1E4E8">result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> mailjet.send.create(</span><span style="color:#FFAB70">data</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">message)</span></span></code></pre>
<p>This code will send the report as an HTML email to the specified recipient. You can customize the email message by modifying the <code>message</code> dictionary.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#E1E4E8"> &#x3C;!</span><span style="color:#85E89D">DOCTYPE</span><span style="color:#B392F0"> HTML</span><span style="color:#B392F0"> PUBLIC</span><span style="color:#9ECBFF"> "-//W3C//DTD HTML 4.01 Transitional//EN"</span><span style="color:#9ECBFF"> "http://www.w3.org/TR/html4/loose.dtd"</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">html</span><span style="color:#B392F0"> lang</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"en"</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">head</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#85E89D">meta</span><span style="color:#B392F0"> http-equiv</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"Content-Type"</span><span style="color:#B392F0"> content</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"text/html; charset=UTF-8"</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#85E89D">meta</span><span style="color:#B392F0"> name</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"viewport"</span><span style="color:#B392F0"> content</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"width=device-width, initial-scale=1"</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#85E89D">meta</span><span style="color:#B392F0"> http-equiv</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"X-UA-Compatible"</span><span style="color:#B392F0"> content</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"IE=edge"</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#85E89D">title</span><span style="color:#E1E4E8">>&#x3C;/</span><span style="color:#85E89D">title</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#85E89D">style</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"text/css"</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;/</span><span style="color:#85E89D">style</span><span style="color:#E1E4E8">>    </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">head</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">body</span><span style="color:#B392F0"> style</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"margin:0; padding:0; background-color:#F2F2F2;"</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#FDAEB7;font-style:italic">center</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#85E89D">table</span><span style="color:#B392F0"> width</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"100%"</span><span style="color:#FDAEB7;font-style:italic"> border</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"0"</span><span style="color:#B392F0"> cellpadding</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"0"</span><span style="color:#B392F0"> cellspacing</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"0"</span><span style="color:#FDAEB7;font-style:italic"> bgcolor</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"#F2F2F2"</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#85E89D">thead</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;</span><span style="color:#85E89D">tr</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            &#x3C;</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">>videoId&#x3C;/</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            &#x3C;</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">>channelId&#x3C;/</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            &#x3C;</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">>description&#x3C;/</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            &#x3C;</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">>title&#x3C;/</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            &#x3C;</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">>phrases&#x3C;/</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            &#x3C;</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">>has report&#x3C;/</span><span style="color:#85E89D">th</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;/</span><span style="color:#85E89D">tr</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;/</span><span style="color:#85E89D">thead</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      {% for full_video_data in EMAIL_DATA %}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;</span><span style="color:#85E89D">tr</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">          &#x3C;</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">>&#x3C;</span><span style="color:#85E89D">a</span><span style="color:#B392F0"> href</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"https://dli-invest.github.io/media_nlp{{full_video_data.get('video_path')}}"</span><span style="color:#E1E4E8">>{{full_video_data.get('videoId')}}&#x3C;/</span><span style="color:#85E89D">a</span><span style="color:#E1E4E8">>&#x3C;/</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">          &#x3C;</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">>{{full_video_data.get('channelId')}}&#x3C;/</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">          &#x3C;</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">>{{full_video_data.get('description')}}&#x3C;/</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">          &#x3C;</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">>&#x3C;</span><span style="color:#85E89D">a</span><span style="color:#B392F0"> href</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"https://www.youtube.com/watch?v={{full_video_data.get('videoId')}}"</span><span style="color:#E1E4E8">>{{full_video_data.get('title')}}&#x3C;/</span><span style="color:#85E89D">a</span><span style="color:#E1E4E8">>&#x3C;/</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">          &#x3C;</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">>{{full_video_data.get('phrases')}}&#x3C;/</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">          &#x3C;</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">>{{full_video_data.get('has_report')}}&#x3C;/</span><span style="color:#85E89D">td</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;/</span><span style="color:#85E89D">tr</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      {% endfor %}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/</span><span style="color:#85E89D">table</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;/</span><span style="color:#FDAEB7;font-style:italic">center</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">body</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">html</span><span style="color:#E1E4E8">> </span></span></code></pre>
<p>This looks like an HTML template that can be used to render a table in an email. The template contains a table with six columns: videoId, channelId, description, title, phrases, and has report. The table header is contained in a thead tag, and the table body is generated dynamically from the EMAIL_DATA variable using a for loop. Each row in the table displays the relevant data for a single video, including a link to the video and a link to the YouTube page. This template can be used with a templating engine like Jinja to generate an email that displays a summary of video data.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/dli-invest/media_nlp">https://github.com/dli-invest/media_nlp</a></li>
</ul> </content></div></div></div></div> <div class="mx-auto max-w-screen-lg px-3 py-6"> <div class="no-print flex w-full"> <form class="max-w-lg" action="https://formspree.io/f/davidli012345@gmail.com" method="POST"><div class="-mx-3 mb-6 flex flex-wrap"><div class="mb-6 w-full px-3 md:mb-0 md:w-1/2"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-first-name">First Name</label><input class="mb-3 block w-full appearance-none rounded py-3 px-4 leading-tight text-gray-700 focus:bg-white focus:outline-none" id="grid-first-name" type="text" placeholder="Jane"/></div><div class="w-full px-3 md:w-1/2"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-last-name">Last Name</label><input class="block w-full appearance-none rounded border border-gray-200  py-3 px-4 leading-tight text-gray-700 focus:border-gray-500 focus:bg-white focus:outline-none" id="grid-last-name" type="text" placeholder="Doe"/></div></div><div class="-mx-3 mb-6 flex flex-wrap"><div class="w-full px-3"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-password">E-mail</label><input class="mb-3 block w-full appearance-none rounded border py-3 px-4 leading-tight text-gray-700 focus:border-gray-500 focus:bg-white focus:outline-none" id="email" type="email"/></div></div><div class="-mx-3 mb-6 flex flex-wrap"><div class="w-full px-3"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-password">Message</label><textarea class="no-resize mb-3 block h-48 w-full resize-none appearance-none rounded border border-gray-200 py-3 px-4 leading-tight text-gray-700 focus:border-gray-500 focus:bg-white focus:outline-none" id="message"></textarea></div></div><div class="md:flex md:items-center"><div class="md:w-1/3"><button class="ml-2 shrink-0 rounded-full bg-gradient-to-br from-sky-500 to-cyan-400 px-3 py-1 text-sm font-medium text-gray-700 hover:from-sky-700 hover:to-cyan-600 focus:outline-none focus:ring-2 focus:ring-cyan-600/50" type="submit">Send</button></div><div class="md:w-2/3"></div></div></form> <div class="ml-3 max-w-lg bg-slate-300"> <link href="/pagefind/pagefind-ui.css" rel="stylesheet"> <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script> <div id="search" class="ml-3 p-4"></div> <script type="module">window.addEventListener("DOMContentLoaded",e=>{setTimeout(()=>{new PagefindUI({element:"#search"})},2e3)});</script> </div> </div> </div>  </div> <div class="mx-auto max-w-screen-lg px-3 py-6"><div class="no-print border-t border-gray-600 pt-5"><div class="text-sm text-gray-200">© Copyright <!-- -->2026<!-- --> by <!-- -->FriendlyUsers Tech Blog<!-- -->. Built with ♥ by<!-- --> <a class="text-cyan-400 hover:underline" href="https://github.com/FriendlyUser" target="_blank" rel="noopener noreferrer">FriendlyUser</a>. Last updated on <!-- -->2026-02-26<!-- -->.</div></div><script src="https://cdn.botpress.cloud/webchat/v0/inject.js"></script><script src="https://mediafiles.botpress.cloud/0df54034-3318-451a-aed0-3923a4ee25a5/webchat/config.js" defer=""></script></div> </body></html>