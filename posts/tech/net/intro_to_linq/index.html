<!DOCTYPE html><html lang="en"><head><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Introduction to LINQ - Astro Tech Blog</title><meta name="description" content="LINQ is a powerful tool for querying data. In this post, we'll look at how to use LINQ to query data in C#."><meta name="author" content="David Li"><link rel="alternate" type="application/rss+xml" href="/rss.xml"><link rel="icon" type="image/x-icon" href="/favicon.ico"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2479144310234386" crossorigin="anonymous"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119155027-6"></script><script type="text/javascript">
      let slideIndex = 1;
      showSlides(slideIndex);

      function plusSlides(n) {
        showSlides((slideIndex += n));
      }

      function currentSlide(n) {
        showSlides((slideIndex = n));
      }

      function showSlides(n) {
        try {
          let i;
          let slides = document.getElementsByClassName('mySlides');
          let dots = document.getElementsByClassName('demo');
          let captionText = document.getElementById('caption');
          if (n > slides.length) {
            slideIndex = 1;
          }
          if (n < 1) {
            slideIndex = slides.length;
          }
          for (i = 0; i < slides.length; i++) {
            slides[i].style.display = 'none';
          }
          for (i = 0; i < dots.length; i++) {
            dots[i].className = dots[i].className.replace(' active', '');
          }
          slides[slideIndex - 1].style.display = 'block';
          dots[slideIndex - 1].className += ' active';
          captionText.innerHTML = dots[slideIndex - 1].alt;
        } catch (err) {
          // do nothing here
        }
      }
    </script><link rel="stylesheet" href="/_astro/index.fe829d41.css" />
<style type="text/css">@media print{.no-print,.no-print *{display:none!important}}
</style><script type="module" src="/_astro/hoisted.d5e551f8.js"></script></head><body class="bg-slate-900 text-gray-100"><div class="mx-auto max-w-screen-lg px-3 py-6"><div class="flex flex-col gap-y-3 sm:flex-row sm:items-center sm:justify-between"><a href="/"><div class="flex items-center bg-gradient-to-br from-sky-500 to-cyan-400 bg-clip-text text-xl font-bold text-transparent"><svg class="mr-1 h-10 w-10 stroke-cyan-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M0 0h24v24H0z" stroke="none"></path><rect x="3" y="12" width="6" height="8" rx="1"></rect><rect x="9" y="8" width="6" height="12" rx="1"></rect><rect x="15" y="4" width="6" height="16" rx="1"></rect><path d="M4 20h14"></path></svg>David&#x27;s Blog</div></a><nav><ul class="flex gap-x-3 font-medium text-gray-200"><li class="hover:text-white"><a href="/posts">Blogs</a></li><li class="hover:text-white"><a href="https://github.com/FriendlyUser/astro-tech-blog">GitHub</a></li><li class="hover:text-white"><a href="/photos">Photos</a></li></ul></nav></div></div><div data-pagefind-body><div class="mx-auto max-w-screen-lg px-3 py-6"><div><h1 class="text-center text-3xl font-bold">Introduction to LINQ</h1><div class="mt-2 text-center text-sm text-gray-400">By <!-- -->David Li<!-- --> on <!-- -->Mon, 13 September 2023</div><div class="flex place-content-center pt-2"><div class="rounded-md px-2 py-1 text-xs font-semibold bg-cyan-400 text-cyan-900"> <a href="/tags/linq" style="padding-right:3px"> <category>linq<!-- --> </category></a></div> <div class="rounded-md px-2 py-1 text-xs font-semibold bg-cyan-400 text-cyan-900"> <a href="/tags/.net" style="padding-right:3px"> <category>.net<!-- --> </category></a></div> </div><div class="mx-auto mt-5 max-w-prose"><div class="aspect-w-3 aspect-h-2"><img class="h-full w-full rounded-lg object-cover object-center" src="/imgs/2023/359551664.png" loading="lazy"/></div><div class="prose prose-invert mt-8 prose-img:rounded-lg"><content><p>LINQ (Language Integrated Query) is a set of language extensions for the Microsoft .NET Framework that allows developers to perform queries on data sources using a syntax similar to SQL. It supports querying data in a variety of formats, including arrays, lists, databases, and XML documents. LINQ was introduced in the .NET Framework version 3.5 and is available in C# and Visual Basic. LINQ makes it easier to write data access code and provides a consistent way to query and manipulate data, regardless of its source.</p>
<p>LINQ queries are composed of a series of operators that can be chained together to filter, transform, and shape data.</p>
<ul>
<li>The “From” operator specifies the data source for the query. This can be an array, list, or any other collection that implements the IEnumerable interface.</li>
<li>The “Where” operator is used to filter the data based on a certain condition. It returns only the elements that match the specified condition.</li>
<li>The “Select” operator is used to project the data into a new form. It allows you to select only the properties or fields that you are interested in and create a new collection of the results.</li>
<li>The “OrderBy” operator is used to sort the data based on a certain property or field. It returns the data in ascending order by default, but can also be used with the “OrderByDescending” operator to sort in descending order.</li>
</ul>
<p>Here is an example of a LINQ query that uses these operators:</p>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> query </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">from</span><span style="color: #F8F8F2"> student </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> students</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">where</span><span style="color: #F8F8F2"> student.Age </span><span style="color: #F92672">></span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">18</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">orderby</span><span style="color: #F8F8F2"> student.LastName, student.FirstName</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">select</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">new</span><span style="color: #F8F8F2"> {student.FirstName, student.LastName};`</span></span></code></pre>
<p>This query selects all students who are older than 18, sorts them by last name, first name, and select the firstname and lastname of the students.</p>
<p>LINQ can be used to query data from a List by using the “From” operator to specify the data source and chaining other operators together to filter, transform, and shape the data.</p>
<p>Here is an example of how to use LINQ to query data from a List of integers:</p>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #A6E22E; text-decoration: underline">List</span><span style="color: #F8F8F2">&#x3C;</span><span style="color: #F92672">int</span><span style="color: #F8F8F2">> numbers </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">new</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E; text-decoration: underline">List</span><span style="color: #F8F8F2">&#x3C;</span><span style="color: #F92672">int</span><span style="color: #F8F8F2">> { </span><span style="color: #AE81FF">1</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">2</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">3</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">4</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">5</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">6</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">7</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">8</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">9</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">10</span><span style="color: #F8F8F2"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #88846F">// Use LINQ to query the data</span></span>
<span class="line"><span style="color: #F92672">var</span><span style="color: #F8F8F2"> evenNumbers </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">from</span><span style="color: #F8F8F2"> number </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> numbers</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">where</span><span style="color: #F8F8F2"> number </span><span style="color: #F92672">%</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">2</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">0</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">select</span><span style="color: #F8F8F2"> number;`</span></span></code></pre>
<p>In this example, the “From” operator specifies that the data source is the “numbers” List, the “Where” operator filters the data to only include even numbers and “Select” operator selects the even numbers.</p>
<p>You can also use the method syntax</p>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> evenNumbers </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> numbers.</span><span style="color: #A6E22E">Where</span><span style="color: #F8F8F2">(n </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> n </span><span style="color: #F92672">%</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">2</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">).</span><span style="color: #A6E22E">Select</span><span style="color: #F8F8F2">(n </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> n);`</span></span></code></pre>
<p>This query will give you the same result as the previous one, but this is the method syntax of LINQ.</p>
<p>You can also use other operators like OrderBy, OrderByDescending, Take, Skip, etc. to shape your data and make it more readable.</p>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> evenNumbers </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> numbers.</span><span style="color: #A6E22E">Where</span><span style="color: #F8F8F2">(n </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> n </span><span style="color: #F92672">%</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">2</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2"> .</span><span style="color: #A6E22E">OrderBy</span><span style="color: #F8F8F2">(n </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> n)</span></span>
<span class="line"><span style="color: #F8F8F2"> .</span><span style="color: #A6E22E">Take</span><span style="color: #F8F8F2">(</span><span style="color: #AE81FF">5</span><span style="color: #F8F8F2">);`</span></span></code></pre>
<p>This query will select the first 5 even numbers from the list and order them by ascending order.</p>
<p>It is important to note that LINQ queries do not execute until they are enumerated, such as by using a foreach loop to iterate through the results.</p>
<p>LINQ can be used to query data from a Dictionary by using the “From” operator to specify the data source and chaining other operators together to filter, transform, and shape the data.</p>
<p>Here is an example of how to use LINQ to query data from a Dictionary&#x3C;string, string>:</p>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #A6E22E; text-decoration: underline">Dictionary</span><span style="color: #F8F8F2">&#x3C;</span><span style="color: #F92672">string</span><span style="color: #F8F8F2">, </span><span style="color: #F92672">string</span><span style="color: #F8F8F2">> colors </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">new</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E; text-decoration: underline">Dictionary</span><span style="color: #F8F8F2">&#x3C;</span><span style="color: #F92672">string</span><span style="color: #F8F8F2">, </span><span style="color: #F92672">string</span><span style="color: #F8F8F2">></span></span>
<span class="line"><span style="color: #F8F8F2">{</span></span>
<span class="line"><span style="color: #F8F8F2"> {</span><span style="color: #E6DB74">"red"</span><span style="color: #F8F8F2">, </span><span style="color: #E6DB74">"#ff0000"</span><span style="color: #F8F8F2">},</span></span>
<span class="line"><span style="color: #F8F8F2"> {</span><span style="color: #E6DB74">"green"</span><span style="color: #F8F8F2">, </span><span style="color: #E6DB74">"#00ff00"</span><span style="color: #F8F8F2">},</span></span>
<span class="line"><span style="color: #F8F8F2"> {</span><span style="color: #E6DB74">"blue"</span><span style="color: #F8F8F2">, </span><span style="color: #E6DB74">"#0000ff"</span><span style="color: #F8F8F2">}</span></span>
<span class="line"><span style="color: #F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #88846F">// Use LINQ to query the data</span></span>
<span class="line"><span style="color: #F92672">var</span><span style="color: #F8F8F2"> hexColors </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">from</span><span style="color: #F8F8F2"> color </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> colors</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">where</span><span style="color: #F8F8F2"> color.Key </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"red"</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">||</span><span style="color: #F8F8F2"> color.Key </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"green"</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">select</span><span style="color: #F8F8F2"> color.Value;`</span></span></code></pre>
<p>In this example, the “From” operator specifies that the data source is the “colors” Dictionary, the “Where” operator filters the data to only include the colors which are red and green, and “Select” operator selects the hex value of the colors.</p>
<p>You can also use the method syntax</p>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> hexColors </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> colors.</span><span style="color: #A6E22E">Where</span><span style="color: #F8F8F2">(c </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> c.Key </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"red"</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">||</span><span style="color: #F8F8F2"> c.Key </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"green"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2"> .</span><span style="color: #A6E22E">Select</span><span style="color: #F8F8F2">(c </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> c.Value);`</span></span></code></pre>
<p>This query will give you the same result as the previous one, but this is the method syntax of LINQ.</p>
<p>You can also use other operators like OrderBy, OrderByDescending, Take, Skip, etc. to shape your data and make it more readable.</p>
<p>It is important to note that when working with a Dictionary, the order of elements is not guaranteed, so if you need to order the elements you need to use the <code>ToList()</code> or <code>ToArray()</code> method before applying <code>OrderBy</code> or <code>OrderByDescending</code></p>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> hexColors </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> colors.</span><span style="color: #A6E22E">Where</span><span style="color: #F8F8F2">(c </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> c.Key </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"red"</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">||</span><span style="color: #F8F8F2"> c.Key </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"green"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2"> .</span><span style="color: #A6E22E">ToList</span><span style="color: #F8F8F2">()</span></span>
<span class="line"><span style="color: #F8F8F2"> .</span><span style="color: #A6E22E">OrderBy</span><span style="color: #F8F8F2">(c </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> c.Key)</span></span>
<span class="line"><span style="color: #F8F8F2"> .</span><span style="color: #A6E22E">Select</span><span style="color: #F8F8F2">(c </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> c.Value);`</span></span></code></pre>
<p>This query will select the hex values of red and green colors and order them by their key.</p>
<p>It is important to note that LINQ queries do not execute until they are enumerated, such as by using a foreach loop to iterate through the results.</p>
<p>LINQ can be used to query data from a SQL database by using the LINQ to SQL or the Entity Framework, which are both built on top of LINQ and provide a way to interact with the database using LINQ syntax.</p>
<p>To use LINQ to SQL, you need to create a mapping between the relational database and the object-oriented model. This is done by creating a DataContext class that defines the tables, columns, and relationships in the database. Once the mapping is done you can use LINQ syntax to query the data.</p>
<p>Here is an example of how to use LINQ to SQL to query data from a SQL database:</p>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">using</span><span style="color: #F8F8F2"> (</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> db </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">new</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E; text-decoration: underline">DataContext</span><span style="color: #F8F8F2">())</span></span>
<span class="line"><span style="color: #F8F8F2">{</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> query </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">from</span><span style="color: #F8F8F2"> customer </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> db.Customers</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">where</span><span style="color: #F8F8F2"> customer.Country </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"USA"</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">select</span><span style="color: #F8F8F2"> customer;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">foreach</span><span style="color: #F8F8F2"> (</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> customer </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> query)</span></span>
<span class="line"><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2"> Console.</span><span style="color: #A6E22E">WriteLine</span><span style="color: #F8F8F2">(customer.FirstName </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">" "</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> customer.LastName);</span></span>
<span class="line"><span style="color: #F8F8F2"> }</span></span>
<span class="line"><span style="color: #F8F8F2">}`</span></span></code></pre>
<p>In this example, the “From” operator specifies the data source is the Customers table, the “Where” operator filters the data to only include customers from the USA, and “Select” operator selects the customer.</p>
<p>You can also use the method syntax</p>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">using</span><span style="color: #F8F8F2"> (</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> db </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">new</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E; text-decoration: underline">DataContext</span><span style="color: #F8F8F2">())</span></span>
<span class="line"><span style="color: #F8F8F2">{</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> query </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> db.Customers.</span><span style="color: #A6E22E">Where</span><span style="color: #F8F8F2">(c </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> c.Country </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"USA"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2"> .</span><span style="color: #A6E22E">Select</span><span style="color: #F8F8F2">(c </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> </span><span style="color: #F92672">new</span><span style="color: #F8F8F2"> {c.FirstName, c.LastName});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">foreach</span><span style="color: #F8F8F2"> (</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> customer </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> query)</span></span>
<span class="line"><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2"> Console.</span><span style="color: #A6E22E">WriteLine</span><span style="color: #F8F8F2">(customer.FirstName </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">" "</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> customer.LastName);</span></span>
<span class="line"><span style="color: #F8F8F2"> }</span></span>
<span class="line"><span style="color: #F8F8F2">}`</span></span></code></pre>
<p>This query will give you the same result as the previous one, but this is the method syntax of LINQ.</p>
<p>You can also use other operators like OrderBy, OrderByDescending, Take, Skip, etc. to shape your data and make it more readable.</p>
<p>With entities Framework it’s similar, but you’ll use the “DbContext” class instead of the “DataContext” and you’ll need to create a model of the database using EF Core or EF 6.</p>
<p>It is important to note that LINQ queries against a SQL database are executed when the query is enumerated, such as by using a foreach loop to iterate through the results, or by calling the <code>ToList()</code>, <code>ToArray()</code> or <code>Count()</code> methods.</p>
<p>Also remember that it is a good practice to use the <code>using</code> statement to dispose of the DataContext/DbContext and the opened connection to avoid any memory leaks.</p>
<p>LINQ provides a number of advanced operators that can be used to perform more complex queries.</p>
<ul>
<li>The “GroupBy” operator is used to group elements in a collection based on a certain key. It returns a collection of groups, where each group contains a key and a collection of elements that share that key.</li>
</ul>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> query </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">from</span><span style="color: #F8F8F2"> student </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> students</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">group</span><span style="color: #F8F8F2"> student </span><span style="color: #F92672">by</span><span style="color: #F8F8F2"> student.Department </span><span style="color: #F92672">into</span><span style="color: #F8F8F2"> g</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">select</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">new</span><span style="color: #F8F8F2"> {Department </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> g.Key, Students </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> g};`</span></span></code></pre>
<p>This query groups the students by their department, and returns a collection of groups where each group contains the department name and a collection of students that belong to that department.</p>
<ul>
<li>The “Join” operator is used to join two collections based on a common key. It returns a collection of elements that have matching keys in both collections.</li>
</ul>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> query </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">from</span><span style="color: #F8F8F2"> student </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> students</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">join</span><span style="color: #F8F8F2"> department </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> departments </span><span style="color: #F92672">on</span><span style="color: #F8F8F2"> student.Department </span><span style="color: #F92672">equals</span><span style="color: #F8F8F2"> department.DepartmentName</span></span>
<span class="line"><span style="color: #F8F8F2"> </span><span style="color: #F92672">select</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">new</span><span style="color: #F8F8F2"> {student.FirstName, student.LastName, department.DepartmentName};`</span></span></code></pre>
<p>This query joins the students and departments collections by the department name, and returns a collection of elements that contains the student’s first name, last name, and department name.</p>
<ul>
<li>The “Aggregate” operator is used to apply a function to the elements of a collection and return a single value. It can be used to perform calculations such as sum, average, or count.</li>
</ul>
<pre is:raw="" class="astro-code monokai" style="background-color: #272822; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F8F8F2">`</span><span style="color: #F92672">var</span><span style="color: #F8F8F2"> query </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> students.</span><span style="color: #A6E22E">Where</span><span style="color: #F8F8F2">(s </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> s.Department </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"Computer Science"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2"> .</span><span style="color: #A6E22E">Select</span><span style="color: #F8F8F2">(s </span><span style="color: #F92672">=></span><span style="color: #F8F8F2"> s.Grade)</span></span>
<span class="line"><span style="color: #F8F8F2"> .</span><span style="color: #A6E22E">Average</span><span style="color: #F8F8F2">();`</span></span></code></pre>
<p>This query filters the students collection to only include students from the Computer Science department, selects their grades, and calculates the average grade.</p>
<p>It is important to note that these operators can be combined with other LINQ operators, like “Where”, “Select”, “OrderBy” etc. to create more complex and powerful queries. Also, these operators are executed after the query is enumerated, such as by using a foreach loop to iterate through the results, or by calling the <code>ToList()</code>, <code>ToArray()</code> or <code>Count()</code> methods.</p></content></div></div></div></div><div class="mx-auto max-w-screen-lg px-3 py-6"><div class="no-print flex w-full"><form class="max-w-lg" action="https://formspree.io/f/davidli012345@gmail.com" method="POST"><div class="-mx-3 mb-6 flex flex-wrap"><div class="mb-6 w-full px-3 md:mb-0 md:w-1/2"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-first-name">First Name</label><input class="mb-3 block w-full appearance-none rounded py-3 px-4 leading-tight text-gray-700 focus:bg-white focus:outline-none" id="grid-first-name" type="text" placeholder="Jane"/></div><div class="w-full px-3 md:w-1/2"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-last-name">Last Name</label><input class="block w-full appearance-none rounded border border-gray-200  py-3 px-4 leading-tight text-gray-700 focus:border-gray-500 focus:bg-white focus:outline-none" id="grid-last-name" type="text" placeholder="Doe"/></div></div><div class="-mx-3 mb-6 flex flex-wrap"><div class="w-full px-3"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-password">E-mail</label><input class="mb-3 block w-full appearance-none rounded border py-3 px-4 leading-tight text-gray-700 focus:border-gray-500 focus:bg-white focus:outline-none" id="email" type="email"/></div></div><div class="-mx-3 mb-6 flex flex-wrap"><div class="w-full px-3"><label class="mb-2 block text-xs font-bold uppercase tracking-wide" for="grid-password">Message</label><textarea class="no-resize mb-3 block h-48 w-full resize-none appearance-none rounded border border-gray-200 py-3 px-4 leading-tight text-gray-700 focus:border-gray-500 focus:bg-white focus:outline-none" id="message"></textarea></div></div><div class="md:flex md:items-center"><div class="md:w-1/3"><button class="ml-2 shrink-0 rounded-full bg-gradient-to-br from-sky-500 to-cyan-400 px-3 py-1 text-sm font-medium text-gray-700 hover:from-sky-700 hover:to-cyan-600 focus:outline-none focus:ring-2 focus:ring-cyan-600/50" type="submit">Send</button></div><div class="md:w-2/3"></div></div></form><div class="ml-3 max-w-lg bg-slate-300"><link href="/_pagefind/pagefind-ui.css" rel="stylesheet"><script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script><div id="search" class="ml-3 p-4"></div></div></div></div></div><div class="mx-auto max-w-screen-lg px-3 py-6"><div class="no-print border-t border-gray-600 pt-5"><div class="text-sm text-gray-200">© Copyright <!-- -->2023<!-- --> by <!-- -->Astro Tech Blog<!-- -->. Built with ♥ by<!-- --> <a class="text-cyan-400 hover:underline" href="https://github.com/FriendlyUser" target="_blank" rel="noopener noreferrer">FriendlyUser</a>. Last updated on <!-- -->2023-12-11<!-- -->.</div></div><script src="https://cdn.botpress.cloud/webchat/v0/inject.js"></script><script src="https://mediafiles.botpress.cloud/0df54034-3318-451a-aed0-3923a4ee25a5/webchat/config.js" defer=""></script></div></body></html>